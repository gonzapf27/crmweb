(function(){"use strict";var e={2501:function(e,a,o){var t=o(9963),i=o(6252),c=o(3577),r=o.p+"img/eureka_logo.5da788a0.png";const n={id:"app"},d={key:1,src:r,alt:"Eureka Logo",class:"banner"},l={key:2},s=(0,i._)("hr",null,null,-1);function u(e,a,o,t,r,u){const p=(0,i.up)("TabsNavigation"),h=(0,i.up)("router-view");return(0,i.wg)(),(0,i.iD)("div",n,[null!==e.$store.state.correo?((0,i.wg)(),(0,i.j4)(p,{key:0})):(0,i.kq)("",!0),null!==e.$store.state.correo?((0,i.wg)(),(0,i.iD)("img",d)):(0,i.kq)("",!0),null!==e.$store.state.correo?((0,i.wg)(),(0,i.iD)("h2",l,(0,c.zw)(u.pageTitle),1)):(0,i.kq)("",!0),s,(0,i.Wm)(h)])}const p={class:"tabs"};function h(e,a,o,t,r,n){const d=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)("div",p,[(0,i._)("ul",null,[(0,i._)("li",{class:(0,c.C_)({active:"oportunidades"===r.activeTab}),onClick:a[0]||(a[0]=e=>n.selectTab("oportunidades"))},[(0,i.Wm)(d,{to:"/OportunidadesView"},{default:(0,i.w5)((()=>[(0,i.Uk)(" Oportunidades de venta ")])),_:1})],2),(0,i._)("li",{class:(0,c.C_)({active:"acciones"===r.activeTab}),onClick:a[1]||(a[1]=e=>n.selectTab("acciones"))},[(0,i.Wm)(d,{to:"/ListaAccionesView"},{default:(0,i.w5)((()=>[(0,i.Uk)(" Acciones ")])),_:1})],2),(0,i._)("li",{class:(0,c.C_)({active:"tareas"===r.activeTab,"has-tareas-pendientes":r.tareasPendientes>0,"no-tareas-pendientes":0===r.tareasPendientes}),onClick:a[2]||(a[2]=e=>n.selectTab("tareas"))},[(0,i.Wm)(d,{to:"/tareasPendientesView"},{default:(0,i.w5)((()=>[(0,i._)("span",{style:(0,c.j5)({color:n.textColor})}," Tareas Pendientes ("+(0,c.zw)(r.tareasPendientes)+") ",5)])),_:1})],2)])])}var m=o(6154),g={data(){return{activeTab:"oportunidades",tareasPendientes:0}},computed:{textColor(){return this.tareasPendientes>0?"red":"green"}},created(){this.updateTareasPendientes(),setInterval(this.updateTareasPendientes,1e4)},methods:{selectTab(e){this.activeTab=e},getMiId(){const e=localStorage.getItem("id"),a=JSON.parse(e);return a},async getTareasPendientes(){try{const e=this.getMiId(),a={id:e},o=await m.Z.post("/getNTareasPendientesFromId",a),{message:t}=o.data;return t}catch(e){return console.error("Error al obtener eventos:",e),9999}},async updateTareasPendientes(){this.tareasPendientes=await this.getTareasPendientes()}}},k=o(3744);const b=(0,k.Z)(g,[["render",h]]);var f=b,v={components:{TabsNavigation:f},computed:{pageTitle(){const e=this.$store.state.correo;return`Bienvenido, ${e}!`}},created(){const e=localStorage.getItem("correo");e&&this.$store.commit("setCorreo",e)}};const C=(0,k.Z)(v,[["render",u]]);var A=C,y=o(2201);const w={class:"login-container"},O=(0,i._)("h1",null,"EurekaCRM",-1),S={class:"form-group"},_=(0,i._)("label",{for:"username"},"Correo:",-1),D={class:"form-group"},x=(0,i._)("label",{for:"password"},"Contraseña:",-1),I=(0,i._)("button",{type:"submit",class:"login-button"},"Iniciar sesión",-1),E={id:"Registrarse"},F={class:"login-message"};function P(e,a,o,r,n,d){const l=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)("div",w,[O,(0,i._)("form",{onSubmit:a[2]||(a[2]=(0,t.iM)(((...e)=>d.login&&d.login(...e)),["prevent"])),class:"login-form"},[(0,i._)("div",S,[_,(0,i.wy)((0,i._)("input",{id:"username",type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>n.username=e),required:""},null,512),[[t.nr,n.username]])]),(0,i._)("div",D,[x,(0,i.wy)((0,i._)("input",{id:"password",type:"password","onUpdate:modelValue":a[1]||(a[1]=e=>n.password=e),required:""},null,512),[[t.nr,n.password]])]),I],32),(0,i._)("div",E,[(0,i.Wm)(l,{to:"SingUpView"},{default:(0,i.w5)((()=>[(0,i.Uk)("¿No tienes una cuenta? Registrarse")])),_:1})]),(0,i._)("p",F,(0,c.zw)(n.message),1)])}o(7658);var q={data(){return{username:"",password:"",message:"",showPassword:!1}},methods:{async darPermisos(){try{const e=await m.Z.post("/esAdmin",{correo:this.username}),{esAdmin:a}=e.data;a&&this.$store.commit("setEsAdmin",!0)}catch(e){console.error(e),this.message="Error al obtener los usuarios"}},async guardarId(){try{const e=await m.Z.post("/getIdFromCorreo",{correo:this.username}),{message:a}=e.data,o=a,t=JSON.stringify(o);localStorage.setItem("id",t)}catch(e){console.error(e),this.message="Error al obtener los usuarios"}},async guardarCorreo(){try{const e=JSON.stringify(this.username);localStorage.setItem("usuario",e)}catch(e){console.error(e),this.message="Error al obtener los usuarios"}},login(){m.Z.post("/login",{correo:this.username,"contraseña":this.password}).then((e=>{const{message:a,token:o}=e.data;this.message=a,"OK"===a&&(console.log("Sesión iniciada"),this.$store.commit("setCorreo",this.username),this.guardarId(),this.guardarCorreo(),this.darPermisos(),this.$router.push({name:"HomeView"})),console.log(o)})).catch((e=>{console.error(e),console.log(e),this.message="Error al iniciar sesión"}))},toggleShowPassword(){this.showPassword=!this.showPassword}}};const z=(0,k.Z)(q,[["render",P]]);var N=z;const R={class:"login-container"},j=(0,i._)("h1",null,"EurekaCRM",-1),V={class:"form-group"},T=(0,i._)("label",{for:"correo"},"Correo:",-1),M={class:"form-group"},L=(0,i._)("label",{for:"contraseña"},"Contraseña:",-1),U=(0,i._)("button",{type:"submit",class:"login-button"},"Registrarse",-1),H={id:"Registrarse"},B={class:"login-message"};function Z(e,a,o,r,n,d){const l=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)("div",R,[j,(0,i._)("form",{onSubmit:a[2]||(a[2]=(0,t.iM)(((...e)=>d.register&&d.register(...e)),["prevent"])),class:"login-form"},[(0,i._)("div",V,[T,(0,i.wy)((0,i._)("input",{id:"correo",type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>n.correo=e),required:""},null,512),[[t.nr,n.correo]])]),(0,i._)("div",M,[L,(0,i.wy)((0,i._)("input",{id:"contraseña",type:"password","onUpdate:modelValue":a[1]||(a[1]=e=>n.contraseña=e),required:""},null,512),[[t.nr,n.contraseña]])]),U],32),(0,i._)("div",H,[(0,i.Wm)(l,{to:"LoginView"},{default:(0,i.w5)((()=>[(0,i.Uk)("¿Ya tienes una cuenta? Iniciar sesión")])),_:1})]),(0,i._)("p",B,(0,c.zw)(n.message),1)])}var $={data(){return{correo:"","contraseña":"",message:"",showPassword:!1}},methods:{register(){m.Z.post("/singUp",{correo:this.correo,"contraseña":this.contraseña,fechaCreacionDia:this.fechaCreacionDia,fechaCreacionMes:this.fechaCreacionMes,"fechaCreacionAño":this.fechaCreacionAño}).then((e=>{const{message:a,token:o}=e.data;this.message=a,console.log(o)})).catch((e=>{console.error(e),this.message="Error al registrarse."}))},toggleShowPassword(){this.showPassword=!this.showPassword},updateFechaNacimiento(){const e=new Date(this.fechaNacimiento);this.fechaNacimientoDia=e.getDate().toString().padStart(2,"0"),this.fechaNacimientoMes=(e.getMonth()+1).toString().padStart(2,"0"),this.fechaNacimientoAño=e.getFullYear().toString();const a=new Date;this.fechaCreacionDia=a.getDate().toString().padStart(2,"0"),this.fechaCreacionMes=(a.getMonth()+1).toString().padStart(2,"0"),this.fechaCreacionAño=a.getFullYear().toString()}}};const J=(0,k.Z)($,[["render",Z]]);var W=J;const Y={class:"page"};function G(e,a,o,t,r,n){const d=(0,i.up)("router-view");return(0,i.wg)(),(0,i.iD)("div",Y,[(0,i._)("h1",null,(0,c.zw)(n.pageTitle),1),(0,i.Wm)(d)])}var Q={components:{},data(){return{activeTab:"oportunidades",tareasPendientes:0}},computed:{pageTitle(){const e=this.$store.state.correo;return`Bienvenido, ${e}!`}},created(){this.updateTareasPendientes(),setInterval(this.updateTareasPendientes,6e4)},methods:{selectTab(e){this.activeTab=e},getTareasPendientes(){return 11},updateTareasPendientes(){this.tareasPendientes=this.getTareasPendientes()}}};const K=(0,k.Z)(Q,[["render",G],["__scopeId","data-v-27678c8e"]]);var X=K;const ee=e=>((0,i.dD)("data-v-c5eef848"),e=e(),(0,i.Cn)(),e),ae=(0,i.uE)('<hr data-v-c5eef848><fieldset name="fieldset_mostrar_columnas" data-v-c5eef848><h4 style="color:blue;" data-v-c5eef848> Mostrar columnas </h4><br data-v-c5eef848><div class="checkbox-container" data-v-c5eef848><label data-v-c5eef848><input id="checkId" type="checkbox" name="checkId" checked data-v-c5eef848> Id </label><label data-v-c5eef848><input id="checkProducto" type="checkbox" name="checkProducto" checked data-v-c5eef848> Producto </label><label data-v-c5eef848><input id="checkEmpresa" type="checkbox" name="checkEmpresa" checked data-v-c5eef848> Empresa </label><label data-v-c5eef848><input id="checkPoblacion" type="checkbox" name="checkPoblacion" checked data-v-c5eef848> Población </label><label data-v-c5eef848><input id="checkNombre" type="checkbox" name="checkNombre" checked data-v-c5eef848> Nombre </label><label data-v-c5eef848><input id="checkApellido1" type="checkbox" name="checkApellido1" checked data-v-c5eef848> Apellido1 </label><label data-v-c5eef848><input id="checkApellido2" type="checkbox" name="checkApellido2" checked data-v-c5eef848> Apellido2 </label></div><div class="checkbox-container" data-v-c5eef848><label data-v-c5eef848><input id="checkTelefono1" type="checkbox" name="checkTelefono1" checked data-v-c5eef848> Teléfono1 </label><label data-v-c5eef848><input id="checkTelefono2" type="checkbox" name="checkTelefono2" checked data-v-c5eef848> Teléfono2 </label><label data-v-c5eef848><input id="checkCorreo1" type="checkbox" name="checkCorreo1" checked data-v-c5eef848> Correo1 </label><label data-v-c5eef848><input id="checkCorreo2" type="checkbox" name="checkCorreo2" checked data-v-c5eef848> Correo2 </label><label data-v-c5eef848><input id="checkComercial" type="checkbox" name="checkComercial" checked data-v-c5eef848> Comercial Asignado </label><label data-v-c5eef848><input id="checkAceptadaPorAdministradorstrador" type="checkbox" name="checkAceptadaPorAdministradorstrador" checked data-v-c5eef848> Aceptada por administrador </label><label data-v-c5eef848><input id="checkFechaCreacion" type="checkbox" name="checkFechaCreacion" checked data-v-c5eef848> Fecha creación </label></div></fieldset>',2),oe={name:"fieldset_filtros"},te=(0,i.uE)('<h4 data-v-c5eef848>Filtros</h4><input id="txtProducto" type="text" placeholder="Producto" data-v-c5eef848><input id="txtEmpresa" type="text" placeholder="Empresa" data-v-c5eef848><input id="txtPoblacion" type="text" placeholder="Población" data-v-c5eef848><input id="txtNombre" type="text" placeholder="Nombre" data-v-c5eef848><input id="txtApellido1" type="text" placeholder="Apellido1" data-v-c5eef848><input id="txtApellido2" type="text" placeholder="Apellido2" data-v-c5eef848><input id="txtTelefono1" type="text" placeholder="Teléfono1" data-v-c5eef848><input id="txtTelefono2" type="text" placeholder="Teléfono2" data-v-c5eef848><input id="txtCorreo1" type="text" placeholder="Correo1" data-v-c5eef848><input id="txtCorreo2" type="text" placeholder="Correo2" data-v-c5eef848>',11),ie={key:0,id:"txtComercial",type:"text",placeholder:"Comercial Asignado"},ce=ee((()=>(0,i._)("label",{for:"selectAceptadaPorAdministrador"},"Aceptada por administrador",-1))),re=ee((()=>(0,i._)("option",{value:"todas",selected:""}," Todas ",-1))),ne=ee((()=>(0,i._)("option",{value:"si"}," Si ",-1))),de=ee((()=>(0,i._)("option",{value:"no"}," No ",-1))),le=[re,ne,de],se=ee((()=>(0,i._)("hr",null,null,-1))),ue=ee((()=>(0,i._)("label",{for:"txtFechaDesde"},"Fecha Desde:",-1))),pe=ee((()=>(0,i._)("label",{for:"txtFechaHasta"},"Fecha Hasta:",-1))),he=ee((()=>(0,i._)("hr",null,null,-1))),me=ee((()=>(0,i._)("label",{for:"orderSelect"},"Ordenar por ",-1))),ge=ee((()=>(0,i._)("option",{value:"fecha_desc"}," Fecha creación (más nuevo a más antiguo) ",-1))),ke=ee((()=>(0,i._)("option",{value:"fecha_asc"}," Fecha creación (más antiguo a más nuevo) ",-1))),be={key:0,value:"comercial_asignado"},fe=ee((()=>(0,i._)("option",{value:"aceptadaPorAdministradorstrador"}," Aceptada por administrador ",-1))),ve=ee((()=>(0,i._)("hr",null,null,-1))),Ce={class:"custom-table"},Ae={key:0},ye={key:1},we={key:2},Oe={key:3},Se={key:4},_e={key:5},De={key:6},xe={key:7},Ie={key:8},Ee={key:9},Fe={key:10},Pe={key:11},qe={key:12},ze={key:13},Ne={key:14},Re={key:0},je=["onClick"],Ve={key:1},Te={key:2},Me={key:3},Le={key:4},Ue={key:5},He={key:6},Be={key:7},Ze={key:8},$e={key:9},Je={key:10},We={key:11},Ye={key:12},Ge={key:13},Qe={key:14};function Ke(e,a,o,r,n,d){const l=(0,i.up)("sideBarAñadir"),s=(0,i.up)("sideBarAgregarAccionOportunidadVenta");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i._)("h1",null,(0,c.zw)(d.pageTitle),1),ae,(0,i._)("fieldset",oe,[te,e.$store.state.esAdmin?((0,i.wg)(),(0,i.iD)("input",ie)):(0,i.kq)("",!0),ce,(0,i.wy)((0,i._)("select",{id:"selectAceptadaPorAdministrador","onUpdate:modelValue":a[0]||(a[0]=e=>n.aceptadaPorAdministradorOpcion=e),name:"selectAceptadaPorAdministrador"},le,512),[[t.bM,n.aceptadaPorAdministradorOpcion]]),se,(0,i._)("div",null,[ue,(0,i.wy)((0,i._)("input",{id:"txtFechaDesde","onUpdate:modelValue":a[1]||(a[1]=e=>n.fechaDesde=e),type:"date"},null,512),[[t.nr,n.fechaDesde]])]),(0,i._)("div",null,[pe,(0,i.wy)((0,i._)("input",{id:"txtFechaHasta","onUpdate:modelValue":a[2]||(a[2]=e=>n.fechaHasta=e),type:"date"},null,512),[[t.nr,n.fechaHasta]])]),he,me,(0,i.wy)((0,i._)("select",{id:"orderSelect","onUpdate:modelValue":a[3]||(a[3]=e=>n.selectedOrder=e)},[ge,ke,e.$store.state.esAdmin?((0,i.wg)(),(0,i.iD)("option",be," Comercial asignado ")):(0,i.kq)("",!0),fe],512),[[t.bM,n.selectedOrder]]),(0,i._)("button",{id:"btn_ejecutar_consulta",onClick:a[4]||(a[4]=(...e)=>d.ejecutarConsulta&&d.ejecutarConsulta(...e))}," Ejecutar consulta "),(0,i._)("button",{class:"botonExportar",onClick:a[5]||(a[5]=(...e)=>d.exportarCSV&&d.exportarCSV(...e))}," Exportar tabla a CSV ")]),ve,(0,i._)("button",{class:"add-button",onClick:a[6]||(a[6]=(...e)=>d.toggleSidebar&&d.toggleSidebar(...e))}," Agregar oportunidad de venta "),(0,i.Wm)(t.uT,{name:"slide"},{default:(0,i.w5)((()=>[n.showSidebar?((0,i.wg)(),(0,i.j4)(l,{key:0,onCancel:d.toggleSidebar,onClick:a[7]||(a[7]=(0,t.iM)((()=>{}),["stop"]))},null,8,["onCancel"])):(0,i.kq)("",!0)])),_:1}),(0,i.Wm)(t.uT,{name:"slide"},{default:(0,i.w5)((()=>[n.showSideBarAgregarAccionUsuario?((0,i.wg)(),(0,i.j4)(s,{key:0,onCancel:a[8]||(a[8]=a=>d.agregarAccion(e.usuario)),onClick:a[9]||(a[9]=(0,t.iM)((()=>{}),["stop"]))})):(0,i.kq)("",!0)])),_:1}),(0,i._)("table",Ce,[(0,i._)("thead",null,[(0,i._)("tr",null,[d.isColumnSelected("checkAccion")?((0,i.wg)(),(0,i.iD)("th",Ae," Acción ")):(0,i.kq)("",!0),d.isColumnSelected("checkId")?((0,i.wg)(),(0,i.iD)("th",ye," ID ")):(0,i.kq)("",!0),d.isColumnSelected("checkProducto")?((0,i.wg)(),(0,i.iD)("th",we," Producto ")):(0,i.kq)("",!0),d.isColumnSelected("checkEmpresa")?((0,i.wg)(),(0,i.iD)("th",Oe," Empresa ")):(0,i.kq)("",!0),d.isColumnSelected("checkPoblacion")?((0,i.wg)(),(0,i.iD)("th",Se," Población ")):(0,i.kq)("",!0),d.isColumnSelected("checkNombre")?((0,i.wg)(),(0,i.iD)("th",_e," Nombre ")):(0,i.kq)("",!0),d.isColumnSelected("checkApellido1")?((0,i.wg)(),(0,i.iD)("th",De," Apellido1 ")):(0,i.kq)("",!0),d.isColumnSelected("checkApellido2")?((0,i.wg)(),(0,i.iD)("th",xe," Apellido2 ")):(0,i.kq)("",!0),d.isColumnSelected("checkTelefono1")?((0,i.wg)(),(0,i.iD)("th",Ie," Teléfono1 ")):(0,i.kq)("",!0),d.isColumnSelected("checkTelefono2")?((0,i.wg)(),(0,i.iD)("th",Ee," Teléfono2 ")):(0,i.kq)("",!0),d.isColumnSelected("checkCorreo1")?((0,i.wg)(),(0,i.iD)("th",Fe," Correo1 ")):(0,i.kq)("",!0),d.isColumnSelected("checkCorreo2")?((0,i.wg)(),(0,i.iD)("th",Pe," Correo2 ")):(0,i.kq)("",!0),d.isColumnSelected("checkComercial")?((0,i.wg)(),(0,i.iD)("th",qe," Comercial Asignado ")):(0,i.kq)("",!0),d.isColumnSelected("checkAceptadaPorAdministradorstrador")?((0,i.wg)(),(0,i.iD)("th",ze," Aceptada por Administrador ")):(0,i.kq)("",!0),d.isColumnSelected("checkFechaCreacion")?((0,i.wg)(),(0,i.iD)("th",Ne," Fecha Creación ")):(0,i.kq)("",!0)])]),(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.usuarios,(e=>((0,i.wg)(),(0,i.iD)("tr",{key:e.id},[d.isColumnSelected("checkAccion")?((0,i.wg)(),(0,i.iD)("td",Re,[d.mostrarBotonAgregarAccion(e)?((0,i.wg)(),(0,i.iD)("button",{key:0,class:"accion-button",onClick:a=>d.agregarAccion(e)}," Agregar acción ",8,je)):(0,i.kq)("",!0)])):(0,i.kq)("",!0),d.isColumnSelected("checkId")?((0,i.wg)(),(0,i.iD)("td",Ve,(0,c.zw)(e.idOportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkProducto")?((0,i.wg)(),(0,i.iD)("td",Te,(0,c.zw)(e.productoOportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkEmpresa")?((0,i.wg)(),(0,i.iD)("td",Me,(0,c.zw)(e.empresaOportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkPoblacion")?((0,i.wg)(),(0,i.iD)("td",Le,(0,c.zw)(e.poblacionOportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkNombre")?((0,i.wg)(),(0,i.iD)("td",Ue,(0,c.zw)(e.nombreOportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkApellido1")?((0,i.wg)(),(0,i.iD)("td",He,(0,c.zw)(e.apellido1Oportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkApellido2")?((0,i.wg)(),(0,i.iD)("td",Be,(0,c.zw)(e.apellido2Oportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkTelefono1")?((0,i.wg)(),(0,i.iD)("td",Ze,(0,c.zw)(e.telefono1Oportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkTelefono2")?((0,i.wg)(),(0,i.iD)("td",$e,(0,c.zw)(e.telefono2Oportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkCorreo1")?((0,i.wg)(),(0,i.iD)("td",Je,(0,c.zw)(e.correo1Oportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkCorreo2")?((0,i.wg)(),(0,i.iD)("td",We,(0,c.zw)(e.correo2Oportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkComercial")?((0,i.wg)(),(0,i.iD)("td",Ye,(0,c.zw)(e.correoUsuarios),1)):(0,i.kq)("",!0),d.isColumnSelected("checkAceptadaPorAdministradorstrador")?((0,i.wg)(),(0,i.iD)("td",Ge,(0,c.zw)(e.aceptadaPorAdministradorOportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkFechaCreacion")?((0,i.wg)(),(0,i.iD)("td",Qe,(0,c.zw)(d.formatFecha(e.fechaDiaCreacionOportunidad,e.fechaMesCreacionOportunidad,e.fechaAñoCreacionOportunidad)),1)):(0,i.kq)("",!0)])))),128))])])])}o(6229),o(7330),o(2062);const Xe=e=>((0,i.dD)("data-v-305303f5"),e=e(),(0,i.Cn)(),e),ea={class:"sidebar"},aa=Xe((()=>(0,i._)("h2",null,"Agregar Oportunidad de Venta",-1))),oa={class:"form-row"},ta={class:"form-group"},ia=Xe((()=>(0,i._)("label",{for:"producto"},"Producto*",-1))),ca={class:"form-group"},ra=Xe((()=>(0,i._)("label",{for:"empresa"},"Empresa*",-1))),na={class:"form-row"},da={class:"form-group"},la=Xe((()=>(0,i._)("label",{for:"poblacion"},"Población",-1))),sa={class:"form-group"},ua=Xe((()=>(0,i._)("label",{for:"nombre"},"Nombre",-1))),pa={class:"form-row"},ha={class:"form-group"},ma=Xe((()=>(0,i._)("label",{for:"apellido1"},"Apellido 1",-1))),ga={class:"form-group"},ka=Xe((()=>(0,i._)("label",{for:"apellido2"},"Apellido 2",-1))),ba={class:"form-row"},fa={class:"form-group"},va=Xe((()=>(0,i._)("label",{for:"telefono1"},"Teléfono 1*",-1))),Ca={class:"form-group"},Aa=Xe((()=>(0,i._)("label",{for:"telefono2"},"Teléfono 2",-1))),ya={class:"form-row"},wa={class:"form-group"},Oa=Xe((()=>(0,i._)("label",{for:"correo1"},"Correo 1*",-1))),Sa={class:"form-group"},_a=Xe((()=>(0,i._)("label",{for:"correo2"},"Correo 2",-1))),Da={class:"form-buttons"},xa=Xe((()=>(0,i._)("button",{type:"submit",class:"submit-button"},"Añadir",-1))),Ia=Xe((()=>(0,i._)("span",{class:"button-separator"},null,-1)));function Ea(e,a,o,c,r,n){return(0,i.wg)(),(0,i.iD)("div",ea,[aa,(0,i._)("form",{onSubmit:a[11]||(a[11]=(0,t.iM)(((...e)=>n.submitForm&&n.submitForm(...e)),["prevent"]))},[(0,i._)("div",oa,[(0,i._)("div",ta,[ia,(0,i.wy)((0,i._)("input",{type:"text",id:"producto","onUpdate:modelValue":a[0]||(a[0]=e=>r.formulario.producto=e),required:""},null,512),[[t.nr,r.formulario.producto]])]),(0,i._)("div",ca,[ra,(0,i.wy)((0,i._)("input",{type:"text",id:"empresa","onUpdate:modelValue":a[1]||(a[1]=e=>r.formulario.empresa=e),required:""},null,512),[[t.nr,r.formulario.empresa]])])]),(0,i._)("div",na,[(0,i._)("div",da,[la,(0,i.wy)((0,i._)("input",{type:"text",id:"poblacion","onUpdate:modelValue":a[2]||(a[2]=e=>r.formulario.poblacion=e)},null,512),[[t.nr,r.formulario.poblacion]])]),(0,i._)("div",sa,[ua,(0,i.wy)((0,i._)("input",{type:"text",id:"nombre","onUpdate:modelValue":a[3]||(a[3]=e=>r.formulario.nombre=e)},null,512),[[t.nr,r.formulario.nombre]])])]),(0,i._)("div",pa,[(0,i._)("div",ha,[ma,(0,i.wy)((0,i._)("input",{type:"text",id:"apellido1","onUpdate:modelValue":a[4]||(a[4]=e=>r.formulario.apellido1=e)},null,512),[[t.nr,r.formulario.apellido1]])]),(0,i._)("div",ga,[ka,(0,i.wy)((0,i._)("input",{type:"text",id:"apellido2","onUpdate:modelValue":a[5]||(a[5]=e=>r.formulario.apellido2=e)},null,512),[[t.nr,r.formulario.apellido2]])])]),(0,i._)("div",ba,[(0,i._)("div",fa,[va,(0,i.wy)((0,i._)("input",{type:"tel",id:"telefono1","onUpdate:modelValue":a[6]||(a[6]=e=>r.formulario.telefono1=e),required:""},null,512),[[t.nr,r.formulario.telefono1]])]),(0,i._)("div",Ca,[Aa,(0,i.wy)((0,i._)("input",{type:"tel",id:"telefono2","onUpdate:modelValue":a[7]||(a[7]=e=>r.formulario.telefono2=e)},null,512),[[t.nr,r.formulario.telefono2]])])]),(0,i._)("div",ya,[(0,i._)("div",wa,[Oa,(0,i.wy)((0,i._)("input",{type:"email",id:"correo1","onUpdate:modelValue":a[8]||(a[8]=e=>r.formulario.correo1=e),required:""},null,512),[[t.nr,r.formulario.correo1]])]),(0,i._)("div",Sa,[_a,(0,i.wy)((0,i._)("input",{type:"email",id:"correo2","onUpdate:modelValue":a[9]||(a[9]=e=>r.formulario.correo2=e)},null,512),[[t.nr,r.formulario.correo2]])])]),(0,i._)("div",Da,[xa,Ia,(0,i._)("button",{type:"button",class:"cancel-button",onClick:a[10]||(a[10]=(...e)=>n.cancelForm&&n.cancelForm(...e))},"Cancelar")])],32)])}var Fa={data(){return{formulario:{producto:"",empresa:"",poblacion:"",nombre:"",apellido1:"",apellido2:"",telefono1:"",telefono2:"",correo1:"",correo2:""},mostrarFormulario:!0}},methods:{getMiId(){const e=localStorage.getItem("id"),a=JSON.parse(e);return a},async comprobarSiEstaEnListaNegra(){try{const e={empresa:this.formulario.empresa,correo1:this.formulario.correo1,correo2:this.formulario.correo2,telefono1:this.formulario.telefono1,telefono2:this.formulario.telefono2},a=await m.Z.post("/estaEnListaNegra",e),{numeroOcurrencias:o}=a.data;if(o>0){const e=window.confirm("Esta empresa tiene datos pertenecientes a nuestra Lista negra!\n¿Quieres añadir la oportunidad de venta igualmente?");return!e}}catch(e){return console.error("Error al comprobar si está en lista negra:",e),alert("Ha ocurrido un error al comprobar si está en lista negra"),!0}},async submitForm(){if(await this.comprobarSiEstaEnListaNegra())return;const e=new Date,a=e.getDate(),o=e.getMonth()+1,t=e.getFullYear(),i={producto:this.formulario.producto,empresa:this.formulario.empresa,poblacion:this.formulario.poblacion,nombre:this.formulario.nombre,apellido1:this.formulario.apellido1,apellido2:this.formulario.apellido2,telefono1:this.formulario.telefono1,telefono2:this.formulario.telefono2,correo1:this.formulario.correo1,correo2:this.formulario.correo2,idComercialAsignado:this.getMiId(),aceptadaPorAdministrador:0,fechaDiaCreacion:a,fechaMesCreacion:o,"fechaAñoCreacion":t,visible:1};try{const e=await m.Z.post("/anadirOportunidadVenta",i),{message:a}=e.data;console.log(a),alert("Oportunidad de venta añadida correctamente"),this.formulario={producto:"",empresa:"",poblacion:"",nombre:"",apellido1:"",apellido2:"",telefono1:"",telefono2:"",correo1:"",correo2:""},this.$emit("cancel")}catch(c){console.error("Error al añadir la oportunidad:",c),alert("Ha ocurrido un error al añadir la oportunidad")}},cancelForm(){this.formulario={producto:"",empresa:"",poblacion:"",nombre:"",apellido1:"",apellido2:"",telefono1:"",telefono2:"",correo1:"",correo2:""},this.$emit("cancel")}}};const Pa=(0,k.Z)(Fa,[["render",Ea],["__scopeId","data-v-305303f5"]]);var qa=Pa;const za=e=>((0,i.dD)("data-v-6446e8de"),e=e(),(0,i.Cn)(),e),Na={class:"sidebar"},Ra={class:"form-row"},ja=za((()=>(0,i._)("label",{for:"accion-select"},"Acción*",-1))),Va=(0,i.uE)('<option value="llamada" data-v-6446e8de> Llamada telefónica </option><option value="correo" data-v-6446e8de> Correo electrónico </option><option value="whatsapp" data-v-6446e8de> WhatsApp </option><option value="visita" data-v-6446e8de> Visita </option><option value="presupuesto" data-v-6446e8de> Presupuesto terminado </option><option value="venta" data-v-6446e8de> Venta realizada </option><option value="contacto" data-v-6446e8de> Pasar a contacto </option>',7),Ta={key:0,value:"aceptarDenegar"},Ma=za((()=>(0,i._)("option",{value:"otro"}," Otro ",-1))),La=za((()=>(0,i._)("option",{value:"listaNegra"}," Enviar a lista negra ",-1))),Ua={key:0,class:"form-row"},Ha=za((()=>(0,i._)("label",{for:"emitir-recibir"},"Autor de la acción*",-1))),Ba={class:"radio-buttons"},Za=za((()=>(0,i._)("label",{for:"emitido"},"Emitir",-1))),$a=za((()=>(0,i._)("span",{class:"button-separator"},null,-1))),Ja=za((()=>(0,i._)("label",{for:"recibido"},"Recibir",-1))),Wa={key:1,id:"parteAsunto",class:"form-row"},Ya={class:"form-group"},Ga=za((()=>(0,i._)("label",{for:"asunto"},"Asunto",-1))),Qa={key:2,id:"parteNotasAdicionales",class:"form-row"},Ka={class:"form-group"},Xa=za((()=>(0,i._)("label",{for:"notas"},"Notas adicionales",-1))),eo={key:3,id:"parteFecha",class:"form-row"},ao={class:"form-group"},oo=za((()=>(0,i._)("label",{for:"fecha"},"Fecha*:",-1))),to={class:"form-group"},io=za((()=>(0,i._)("label",{for:"hora"},"Hora*:",-1))),co={key:4,class:"form-row"},ro={class:"form-group"},no=za((()=>(0,i._)("label",{for:"ri"},"RI*:",-1))),lo={key:5,id:"parteListaNegra",class:"form-row"},so={class:"form-group"},uo=za((()=>(0,i._)("label",{for:"motivoListaNegra"},"Motivo/Notas por el que se lleva a lista negra",-1))),po=za((()=>(0,i._)("br",null,null,-1))),ho={key:6,id:"parteBotonesAceptarCancelar",class:"form-buttons"},mo=za((()=>(0,i._)("span",{class:"button-separator"},null,-1))),go={key:7,id:"parteAceptarDenegar"},ko=za((()=>(0,i._)("label",{for:""},"Asignar y aceptar",-1))),bo=za((()=>(0,i._)("br",null,null,-1))),fo=["value"],vo=za((()=>(0,i._)("hr",null,null,-1))),Co={id:"parteBotonesAceptarDenegar",class:""},Ao=za((()=>(0,i._)("span",{class:"button-separator"},null,-1))),yo=za((()=>(0,i._)("hr",null,null,-1))),wo=za((()=>(0,i._)("label",{for:""},"Denegar",-1))),Oo=za((()=>(0,i._)("hr",null,null,-1))),So=za((()=>(0,i._)("span",{class:"button-separator"},null,-1))),_o={key:8},Do=za((()=>(0,i._)("hr",null,null,-1))),xo=za((()=>(0,i._)("span",{class:"button-separator"},null,-1))),Io=za((()=>(0,i._)("hr",null,null,-1)));function Eo(e,a,o,r,n,d){return(0,i.wg)(),(0,i.iD)("div",Na,[(0,i._)("h2",null,"Agregar acción sobre "+(0,c.zw)(d.getEmpresa()),1),(0,i._)("form",{onSubmit:a[17]||(a[17]=(0,t.iM)(((...e)=>d.submitForm&&d.submitForm(...e)),["prevent"]))},[(0,i._)("div",Ra,[ja,(0,i.wy)((0,i._)("select",{id:"accion-select","onUpdate:modelValue":a[0]||(a[0]=e=>n.accionSeleccionada=e),required:""},[Va,e.$store.state.esAdmin?((0,i.wg)(),(0,i.iD)("option",Ta," Aceptar / Denegar ")):(0,i.kq)("",!0),Ma,La],512),[[t.bM,n.accionSeleccionada]])]),d.mostrarEmitirRecibir()?((0,i.wg)(),(0,i.iD)("div",Ua,[Ha,(0,i._)("div",Ba,[(0,i.wy)((0,i._)("input",{id:"emitido","onUpdate:modelValue":a[1]||(a[1]=e=>n.emitidoORecibido=e),type:"radio",name:"opcion",value:"emitido",required:""},null,512),[[t.G2,n.emitidoORecibido]]),Za,$a,(0,i.wy)((0,i._)("input",{id:"recibido","onUpdate:modelValue":a[2]||(a[2]=e=>n.emitidoORecibido=e),type:"radio",name:"opcion",value:"recibido",required:""},null,512),[[t.G2,n.emitidoORecibido]]),Ja])])):(0,i.kq)("",!0),d.mostrarAsunto()?((0,i.wg)(),(0,i.iD)("div",Wa,[(0,i._)("div",Ya,[Ga,(0,i.wy)((0,i._)("input",{id:"asunto","onUpdate:modelValue":a[3]||(a[3]=e=>n.formulario.asunto=e),type:"text"},null,512),[[t.nr,n.formulario.asunto]])])])):(0,i.kq)("",!0),d.mostrarNotasAdicionales()?((0,i.wg)(),(0,i.iD)("div",Qa,[(0,i._)("div",Ka,[Xa,(0,i.wy)((0,i._)("textarea",{id:"notas","onUpdate:modelValue":a[4]||(a[4]=e=>n.formulario.notas=e),rows:"4",style:{resize:"both"}},null,512),[[t.nr,n.formulario.notas]])])])):(0,i.kq)("",!0),d.mostrarFecha()?((0,i.wg)(),(0,i.iD)("div",eo,[(0,i._)("div",ao,[oo,(0,i.wy)((0,i._)("input",{id:"fecha","onUpdate:modelValue":a[5]||(a[5]=e=>n.formulario.fecha=e),type:"date",required:""},null,512),[[t.nr,n.formulario.fecha]])]),(0,i._)("div",to,[io,(0,i.wy)((0,i._)("input",{id:"hora","onUpdate:modelValue":a[6]||(a[6]=e=>n.formulario.hora=e),type:"time",required:""},null,512),[[t.nr,n.formulario.hora]])])])):(0,i.kq)("",!0),d.mostrarRi()?((0,i.wg)(),(0,i.iD)("div",co,[(0,i._)("div",ro,[no,(0,i.wy)((0,i._)("input",{id:"ri","onUpdate:modelValue":a[7]||(a[7]=e=>n.formulario.ri=e),type:"number",placeholder:"0",min:"0"},null,512),[[t.nr,n.formulario.ri]])])])):(0,i.kq)("",!0),d.mostrarMotivoListaNegra()?((0,i.wg)(),(0,i.iD)("div",lo,[(0,i._)("div",so,[uo,po,(0,i.wy)((0,i._)("textarea",{id:"motivoListaNegra","onUpdate:modelValue":a[8]||(a[8]=e=>n.formulario.motivoListaNegra=e),rows:"4",style:{resize:"both"}},null,512),[[t.nr,n.formulario.motivoListaNegra]])])])):(0,i.kq)("",!0),d.mostrarBotonesAceptarCancelar()?((0,i.wg)(),(0,i.iD)("div",ho,[(0,i._)("button",{type:"submit",class:(0,c.C_)(["submit-button",{"agendar-button":d.esFechaSuperior}])},(0,c.zw)(d.textoBoton),3),(0,i.Uk)(),mo,(0,i._)("button",{type:"button",class:"cancel-button",onClick:a[9]||(a[9]=(...e)=>d.cancelForm&&d.cancelForm(...e))}," Cancelar ")])):(0,i.kq)("",!0),d.mostrarAceptarDenegar()?((0,i.wg)(),(0,i.iD)("div",go,[ko,bo,"aceptarDenegar"===n.accionSeleccionada?(0,i.wy)(((0,i.wg)(),(0,i.iD)("select",{key:0,id:"selectComercial","onUpdate:modelValue":a[10]||(a[10]=e=>n.comercialAsignado=e),name:"selectComercial"},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.listaCorreos,(e=>((0,i.wg)(),(0,i.iD)("option",{key:e,value:e},(0,c.zw)(e),9,fo)))),128))],512)),[[t.bM,n.comercialAsignado]]):(0,i.kq)("",!0),vo,(0,i._)("div",Co,[(0,i._)("button",{id:"btnAsignarComercial",type:"button",onClick:a[11]||(a[11]=(...e)=>d.asignarAlComercial&&d.asignarAlComercial(...e))},"Asignar al comercial"),Ao,(0,i._)("button",{type:"button",class:"cancel-button",onClick:a[12]||(a[12]=(...e)=>d.cancelForm&&d.cancelForm(...e))}," Cancelar "),yo,wo,Oo,(0,i._)("button",{id:"btnAsignarComercial",type:"button",onClick:a[13]||(a[13]=(...e)=>d.denegarATodosComerciales&&d.denegarATodosComerciales(...e))},"Denegar al comercial asignado"),So,(0,i._)("button",{type:"button",class:"cancel-button",onClick:a[14]||(a[14]=(...e)=>d.cancelForm&&d.cancelForm(...e))}," Cancelar ")])])):(0,i.kq)("",!0),d.mostrarPasarAContacto()?((0,i.wg)(),(0,i.iD)("div",_o,[Do,(0,i._)("button",{id:"btnPasarAContacto",type:"button",onClick:a[15]||(a[15]=(...e)=>d.pasarAContacto&&d.pasarAContacto(...e))},"Pasar a contacto"),xo,(0,i._)("button",{type:"button",class:"cancel-button",onClick:a[16]||(a[16]=(...e)=>d.cancelForm&&d.cancelForm(...e))}," Cancelar "),Io])):(0,i.kq)("",!0)],32)])}var Fo={data(){return{formulario:{accionSeleccionada:"",emitidoORecibido:"emitir",asunto:"",notas:"",fecha:"",hora:"",ri:0,motivoListaNegra:""},accionSeleccionada:"llamada",emitidoORecibido:"",mostrarFormulario:!0,listaCorreos:["prueba"],comercialAsignado:""}},computed:{esFechaSuperior(){const e=new Date(this.formulario.fecha),a=new Date;return e.setHours(this.formulario.hora.split(":")[0],this.formulario.hora.split(":")[1],0,0),e.getTime()>a.getTime()},textoBoton(){return this.esFechaSuperior?"Agendar":"Añadir"}},created(){this.obtenerComerciales()},methods:{getEmpresa(){const e=localStorage.getItem("oportunidadVentaSeleccionada"),a=JSON.parse(e);return a.empresaOportunidad},getcorreo1(){const e=localStorage.getItem("oportunidadVentaSeleccionada"),a=JSON.parse(e);return a.correo1Oportunidad},getcorreo2(){const e=localStorage.getItem("oportunidadVentaSeleccionada"),a=JSON.parse(e);return a.correo2Oportunidad},getTelefono1(){const e=localStorage.getItem("oportunidadVentaSeleccionada"),a=JSON.parse(e);return a.telefono1Oportunidad},getTelefono2(){const e=localStorage.getItem("oportunidadVentaSeleccionada"),a=JSON.parse(e);return a.telefono2Oportunidad},getIdOportunidad(){const e=localStorage.getItem("oportunidadVentaSeleccionada"),a=JSON.parse(e);return parseInt(a.idOportunidad)},mostrarEmitirRecibir(){const e=["llamada","correo","whatsapp","visita"];return e.includes(this.accionSeleccionada)},mostrarAsunto(){const e=["llamada","correo","whatsapp","visita","otro"];return e.includes(this.accionSeleccionada)},mostrarNotasAdicionales(){const e=["llamada","correo","whatsapp","visita","otro"];return e.includes(this.accionSeleccionada)},mostrarFecha(){const e=["llamada","correo","whatsapp","visita","otro"];return e.includes(this.accionSeleccionada)},mostrarBotonesAceptarCancelar(){const e=["llamada","correo","whatsapp","visita","presupuesto","venta","otro","listaNegra"];return e.includes(this.accionSeleccionada)},mostrarRi(){const e=["presupuesto","venta"];return e.includes(this.accionSeleccionada)},mostrarMotivoListaNegra(){const e=["listaNegra"];return e.includes(this.accionSeleccionada)},mostrarAceptarDenegar(){return"aceptarDenegar"===this.accionSeleccionada},mostrarPasarAContacto(){return"contacto"===this.accionSeleccionada},getMiId(){const e=localStorage.getItem("id"),a=JSON.parse(e);return a},async getIdDeCorreo(e){try{const a=await m.Z.post("/getIdFromCorreo",{correo:e}),{message:o}=a.data,t=o;return t}catch(a){return console.error("Error al obtener el ID del correo:",a),alert("Ha ocurrido un error al obtener el ID del correo"),null}},async comprobarSiEstaEnListaNegra(){try{const e={empresa:this.getEmpresa(),correo1:this.getcorreo1(),correo2:this.getcorreo2(),telefono1:this.getTelefono1(),telefono2:this.getTelefono2()},a=await m.Z.post("/estaEnListaNegra",e),{numeroOcurrencias:o}=a.data;if(o>0){const e=window.confirm("Esta empresa tiene datos pertenecientes a nuestra Lista negra!\n¿Quieres añadir la oportunidad de venta igualmente?");return!e}}catch(e){return console.error("Error al comprobar si está en lista negra:",e),alert("Ha ocurrido un error al comprobar si está en lista negra"),!0}},async asignarAlComercial(){if(!await this.comprobarSiEstaEnListaNegra())if(""!==this.comercialAsignado){const a=await this.getIdDeCorreo(this.comercialAsignado),o=await this.getIdOportunidad(),t={idCorreo:a,idOportunidad:o};try{const e=await m.Z.post("/asignarOportunidadAComercial",t),{message:a}=e.data;console.log(a),alert("Oportunidad aceptada y asignada al comercial "+this.comercialAsignado),await this.agendarPrimeraAccionAutomatica(),this.cancelForm()}catch(e){console.error("Error al asignar la oportunidad al comercial:",e),alert("Ha ocurrido un error al asignar la oportunidad al comercial")}}else alert("Por favor selecciona un comercial a quien asignarle la oportunidad de venta")},async pasarAContacto(){const e=new Date,a=e.getDate(),o=e.getMonth()+1,t=e.getFullYear(),i=await this.getIdOportunidad(),c={idOportunidad:i,fechaDiaCreacion:a,fechaMesCreacion:o,"fechaAñoCreacion":t};try{const e=await m.Z.post("/crearContacto",c);if(e.data.confirmacion){const a=window.confirm(e.data.confirmacion);if(a){const e=await m.Z.post("/crearContacto",c);console.log(e.data.message)}else console.log("Creación de contacto cancelada por el usuario.")}else console.log(e.data.message)}catch(r){console.error("Error al crear el cliente:",r),alert("Ha ocurrido un error al crear el cliente")}},async agendarPrimeraAccionAutomatica(){if(""!==this.comercialAsignado){const a=await this.getIdDeCorreo(this.comercialAsignado),o=await this.getIdOportunidad(),t={idCorreo:a,idOportunidad:o};try{const e=await m.Z.post("/agendarAccionAutomatica1",t),{message:a}=e.data;alert(a),this.cancelForm()}catch(e){console.error("Error al asignar la oportunidad al comercial:",e),alert("Ha ocurrido un error al asignar la oportunidad al comercial")}}else alert("Por favor selecciona un comercial a quien asignarle la oportunidad de venta")},async denegarATodosComerciales(){const e=await this.getIdOportunidad(),a={idOportunidad:e};try{const e=await m.Z.post("/denegarOportunidadATodos",a),{message:o}=e.data;console.log(o),alert("Oportunidad denegada a todos los comerciales"),this.cancelForm()}catch(o){console.error("Error al denegar la oportunidad a todos los comerciales:",o),alert("Ha ocurrido un error al denegar la oportunidad a todos los comerciales")}},async obtenerComerciales(){try{const e=await m.Z.get("/obtenerComerciales"),{comerciales:a}=e.data;this.listaCorreos=a}catch(e){console.error("Error al obtener los correos de los comerciales:",e),alert("Ha ocurrido un error al obtener los correos de los comerciales")}},async ocultarOportunidad(e){try{const a=await m.Z.post("/ocultarOportunidad",{id:e}),{message:o}=a.data;console.log(o)}catch(a){console.error("Error al ocultar la oportunidad:",a),alert("Ha ocurrido un error al ocultar la oportunidad")}},async crearCliente(e){const a=new Date,o=a.getDate(),t=a.getMonth()+1,i=a.getFullYear(),c={idOportunidad:e,fechaDiaCreacion:o,fechaMesCreacion:t,"fechaAñoCreacion":i};try{const e=await m.Z.post("/crearCliente",c),{message:a}=e.data;console.log(a)}catch(r){console.error("Error al crear el cliente:",r),alert("Ha ocurrido un error al crear el cliente")}},async ejecutarVenta(){const e=await this.getIdOportunidad();await this.crearCliente(e),await this.ocultarOportunidad(e)},async agendarAccion(){const e=new Date(this.formulario.fecha),a=e.getDate(),o=e.getMonth()+1,t=e.getFullYear(),[i,c]=this.formulario.hora.split(":"),r=new Date,n=r.getDate(),d=r.getMonth()+1,l=r.getFullYear(),[s,u]=this.formulario.hora.split(":");let p=0;"recibido"===this.emitidoORecibido&&(p=1);const h={idOportunidad:await this.getIdOportunidad(),idCreador:this.getMiId(),accionObjetivo:this.accionSeleccionada,emitidoORecibidoObjetivo:p,asuntoObjetivo:this.formulario.asunto,notasObjetivo:this.formulario.notas,riObjetivo:this.formulario.ri,fechaDiaObjetivo:a,fechaMesObjetivo:o,"fechaAñoObjetivo":t,horaObjetivo:i,minutoObjetivo:c,fechaDiaCreacion:n,fechaMesCreacion:d,"fechaAñoCreacion":l,horaCreacion:s,minutoCreacion:u};try{const e=await m.Z.post("/agendarAccion",h),{message:a}=e.data;console.log(a),alert("Acción agendada correctamente")}catch(g){console.error("Error al agendar la acción:",g),alert("Ha ocurrido un error al agendar la acción")}},async registrarAccion(){const e=new Date(this.formulario.fecha),a=e.getDate(),o=e.getMonth()+1,t=e.getFullYear(),[i,c]=this.formulario.hora.split(":");let r=0;"recibido"===this.emitidoORecibido&&(r=1);const n={idOportunidad:await this.getIdOportunidad(),idAutor:this.getMiId(),accionRealizada:this.accionSeleccionada,emitidoORecibidoRealizada:r,asuntoRealizada:this.formulario.asunto,notasRealizada:this.formulario.notas,riRealizada:this.formulario.ri,fechaDiaRealizada:a,fechaMesRealizada:o,"fechaAñoRealizada":t,horaRealizada:i,minutoRealizada:c};try{const e=await m.Z.post("/registrarAccionOportunidad",n),{message:a}=e.data;console.log(a),alert("Acción registrada correctamente")}catch(d){console.error("Error al registrar la acción:",d),alert("Ha ocurrido un error al registrar la acción")}},async enviarAListaNegra(){const e=new Date,a=e.getDate(),o=e.getMonth()+1,t=e.getFullYear(),[i,c]=this.formulario.hora.split(":");let r=0;"recibido"===this.emitidoORecibido&&(r=1);const n=this.getIdOportunidad(),d=this.getMiId(),l={idOportunidad:n,idAutor:d,accionRealizada:this.accionSeleccionada,emitidoORecibidoRealizada:r,asuntoRealizada:this.formulario.asunto,notasRealizada:this.formulario.motivoListaNegra,riRealizada:this.formulario.ri,fechaDiaRealizada:a,fechaMesRealizada:o,"fechaAñoRealizada":t,horaRealizada:i,minutoRealizada:c};try{const e=await m.Z.post("/registrarAccionOportunidad",l),{message:a}=e.data;console.log(a),alert("Acción registrada correctamente")}catch(u){console.error("Error al registrar la acción:",u),alert("Ha ocurrido un error al registrar la acción")}const s={idOportunidad:n,idCreador:d,motivo:this.formulario.motivoListaNegra,fechaDiaCreacion:a,fechaMesCreacion:o,"fechaAñoCreacion":t};try{const e=await m.Z.post("/enviarAListaNegraFromIdOportunidad",s),{message:a}=e.data;console.log(a),alert("Se ha enviado la oportunidad a la lista negra.")}catch(u){console.error("Error al enviar a lista negra:",u),alert("Ha ocurrido un error al enviar la oportunidad a la lista negra")}},limpiarFormulario(){this.formulario={accionSeleccionada:"",emitidoORecibido:"",asunto:"",notas:"",fecha:"",hora:"",ri:0}},async submitForm(){"listaNegra"===this.accionSeleccionada?await this.enviarAListaNegra():this.esFechaSuperior?await this.agendarAccion():await this.registrarAccion(),"venta"===this.accionSeleccionada&&this.ejecutarVenta(),this.limpiarFormulario(),this.$emit("cancel")},cancelForm(){this.limpiarFormulario(),this.$emit("cancel")}}};const Po=(0,k.Z)(Fo,[["render",Eo],["__scopeId","data-v-6446e8de"]]);var qo=Po,zo={components:{"sideBarAñadir":qa,sideBarAgregarAccionOportunidadVenta:qo},data(){return{usuarios:[],showSidebar:!1,showSideBarAgregarAccionUsuario:!1,query:"",parametrosQuery:[],selectedOrder:"fecha_desc",fechaDesde:null,fechaHasta:null,accion_sobre:"null",accionTexto:"Empresa",aceptadaPorAdministradorOpcion:"todas"}},computed:{pageTitle(){return"Oportunidades de Venta actuales"}},created(){this.comprobarCorreo()},methods:{toggleSidebar(){this.showSidebar=!this.showSidebar},formatFecha(e,a,o){const t=new Date(o,a-1,e);return t.toLocaleDateString("es-ES")},obtenerEncabezadosSeleccionados(){const e=[];return this.isColumnSelected("checkId")&&e.push("ID"),this.isColumnSelected("checkProducto")&&e.push("Producto"),this.isColumnSelected("checkEmpresa")&&e.push("Empresa"),this.isColumnSelected("checkPoblacion")&&e.push("Población"),this.isColumnSelected("checkNombre")&&e.push("Nombre"),this.isColumnSelected("checkApellido1")&&e.push("Apellido1"),this.isColumnSelected("checkApellido2")&&e.push("Apellido2"),this.isColumnSelected("checkTelefono1")&&e.push("Teléfono1"),this.isColumnSelected("checkTelefono2")&&e.push("Teléfono2"),this.isColumnSelected("checkCorreo1")&&e.push("Correo1"),this.isColumnSelected("checkCorreo2")&&e.push("Correo2"),this.isColumnSelected("checkComercial")&&e.push("Comercial Asignado"),this.isColumnSelected("checkAceptadaPorAdministradorstrador")&&e.push("Aceptada por Administrador"),this.isColumnSelected("checkFechaCreacion")&&e.push("Fecha Creación"),e},obtenerDatosFila(e){const a=[];if(this.isColumnSelected("checkId")&&a.push(e.id),this.isColumnSelected("checkProducto")&&a.push(e.productoOportunidad),this.isColumnSelected("checkEmpresa")&&a.push(e.empresaOportunidad),this.isColumnSelected("checkPoblacion")&&a.push(e.poblacionOportunidad),this.isColumnSelected("checkNombre")&&a.push(e.nombreOportunidad),this.isColumnSelected("checkApellido1")&&a.push(e.apellido1Oportunidad),this.isColumnSelected("checkApellido2")&&a.push(e.apellido2Oportunidad),this.isColumnSelected("checkTelefono1")&&a.push(e.telefono1Oportunidad),this.isColumnSelected("checkTelefono2")&&a.push(e.telefono2Oportunidad),this.isColumnSelected("checkCorreo1")&&a.push(e.correo1Oportunidad),this.isColumnSelected("checkCorreo2")&&a.push(e.correo2Oportunidad),this.isColumnSelected("checkComercial")&&a.push(e.correoUsuarios),this.isColumnSelected("checkAceptadaPorAdministradorstrador")&&a.push(e.aceptadaPorAdministradorOportunidad),this.isColumnSelected("checkFechaCreacion")){const o=this.formatFecha(e.fechaDiaCreacionOportunidad,e.fechaMesCreacionOportunidad,e.fechaAñoCreacionOportunidad);a.push(o)}return a},agregarAccion(e){const a=JSON.stringify(e);localStorage.setItem("oportunidadVentaSeleccionada",a),this.showSideBarAgregarAccionUsuario=!this.showSideBarAgregarAccionUsuario},mostrarBotonAgregarAccion(e){return!!this.$store.state.esAdmin||1===e.aceptadaPorAdministradorOportunidad},exportarCSV(){const e=[],a=this.obtenerEncabezadosSeleccionados();e.push(a),this.usuarios.forEach((a=>{const o=this.obtenerDatosFila(a);e.push(o)}));let o="";e.forEach((e=>{o+=e.map((e=>`"${e}"`)).join(",")+"\n"}));const t=new Blob([o],{type:"text/csv;charset=utf-8;"}),i=window.URL.createObjectURL(t),c=document.createElement("a");c.setAttribute("href",i),c.setAttribute("download","tabla.csv"),c.style.display="none",document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(i)},async comprobarCorreo(){const e=this.$store.state.correo;null===e&&this.$router.push({name:"LoginView"})},isColumnSelected(e){try{const a=document.getElementById(e);return a.checked}catch(a){return!0}},async ejecutarConsulta(){try{const e={fechaDesde:this.fechaDesde,fechaHasta:this.fechaHasta,txtProducto:document.getElementById("txtProducto").value.trim(),txtEmpresa:document.getElementById("txtEmpresa").value.trim(),txtPoblacion:document.getElementById("txtPoblacion").value.trim(),txtNombre:document.getElementById("txtNombre").value.trim(),txtApellido1:document.getElementById("txtApellido1").value.trim(),txtApellido2:document.getElementById("txtApellido2").value.trim(),txtTelefono1:document.getElementById("txtTelefono1").value.trim(),txtTelefono2:document.getElementById("txtTelefono2").value.trim(),txtCorreo1:document.getElementById("txtCorreo1").value.trim(),txtCorreo2:document.getElementById("txtCorreo2").value.trim(),txtComercial:this.$store.state.esAdmin?document.getElementById("txtComercial").value.trim():this.$store.state.correo,aceptadaPorAdministradorOpcion:this.aceptadaPorAdministradorOpcion,selectedOrder:document.getElementById("orderSelect").value},a=await m.Z.post("/getOportunidades",e),{message:o}=a.data;this.usuarios=JSON.parse(o)}catch(e){console.error(e),this.message="Error al obtener las oportunidades"}}}};const No=(0,k.Z)(zo,[["render",Ke],["__scopeId","data-v-c5eef848"]]);var Ro=No;const jo=(0,i._)("h1",null,"Tareas Pendientes",-1),Vo=(0,i._)("br",null,null,-1),To=(0,i._)("br",null,null,-1);function Mo(e,a,o,t,c,r){const n=(0,i.up)("calendarioAgenda");return(0,i.wg)(),(0,i.iD)("div",null,[jo,Vo,To,(0,i.Wm)(n)])}const Lo={key:0,class:"calendar-view"};function Uo(e,a,o,c,r,n){const d=(0,i.up)("FullCalendar"),l=(0,i.up)("sideBarCompletarAccionOportunidadVenta");return(0,i.wg)(),(0,i.iD)("div",null,[r.showSideBarCompletarAccion?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",Lo,[(0,i.Wm)(d,{ref:"calendarRef",options:r.calendarOptions},null,8,["options"])])),(0,i.Wm)(t.uT,{name:"slide"},{default:(0,i.w5)((()=>[r.showSideBarCompletarAccion?((0,i.wg)(),(0,i.j4)(l,{key:0,onCancel:n.hideSideBarCompletarAccion,onClick:a[0]||(a[0]=(0,t.iM)((()=>{}),["stop"]))},null,8,["onCancel"])):(0,i.kq)("",!0)])),_:1})])}var Ho=o(4813),Bo=o(1132),Zo=o(9897),$o=o(4102);const Jo=e=>((0,i.dD)("data-v-a50b5342"),e=e(),(0,i.Cn)(),e),Wo={class:"sidebar"},Yo={class:"form-row"},Go=Jo((()=>(0,i._)("label",{for:"asunto-objetivo"},"Asunto Objetivo",-1))),Qo=["value"],Ko={class:"form-row"},Xo=Jo((()=>(0,i._)("label",{for:"notas-objetivo"},"Notas Objetivo",-1))),et=["value"],at={class:"form-row"},ot=Jo((()=>(0,i._)("label",{for:"asunto-realizado"},"Asunto Realizado",-1))),tt={class:"form-row"},it=Jo((()=>(0,i._)("label",{for:"notas-realizadas"},"Notas Realizadas",-1))),ct={key:0,class:"form-row"},rt=Jo((()=>(0,i._)("label",{for:"conocio-select"},"Como nos conoció",-1))),nt=Jo((()=>(0,i._)("option",{value:"internet"}," Internet ",-1))),dt=Jo((()=>(0,i._)("option",{value:"otroCliente"}," A través de otro cliente ",-1))),lt=Jo((()=>(0,i._)("option",{value:"publicidad"}," Publicidad ",-1))),st=Jo((()=>(0,i._)("option",{value:"otro"}," Otro... ",-1))),ut=[nt,dt,lt,st],pt={key:1},ht=Jo((()=>(0,i._)("p",null,"¿Es la persona encargada en tomar la decisión?",-1))),mt=Jo((()=>(0,i._)("span",{class:"radio-separator"},null,-1))),gt={key:2,class:"form-row"},kt=Jo((()=>(0,i._)("label",{for:"plazo-estimadoDias"},"Plazo estimado (en días)",-1))),bt={key:3,class:"form-row"},ft=Jo((()=>(0,i._)("label",{for:"guardarRi"},"RI asignado",-1))),vt={key:4,class:"form-row"},Ct=Jo((()=>(0,i._)("p",null,"¿Que forma de pago se utilizará?",-1))),At=Jo((()=>(0,i._)("span",{class:"radio-separator"},null,-1))),yt={class:"form-row"},wt=Jo((()=>(0,i._)("label",{for:"fechaInstalacionProvisional"},"Fecha de instalación provisional",-1))),Ot={class:"form-buttons"},St=Jo((()=>(0,i._)("button",{type:"submit",class:"submit-button"}," Completar acción ",-1))),_t=Jo((()=>(0,i._)("span",{class:"button-separator"},null,-1)));function Dt(e,a,o,r,n,d){return(0,i.wg)(),(0,i.iD)("div",Wo,[(0,i._)("h2",null,"Completar acción sobre "+(0,c.zw)(d.getEmpresa()),1),(0,i._)("form",{onSubmit:a[11]||(a[11]=(0,t.iM)(((...e)=>d.submitForm&&d.submitForm(...e)),["prevent"]))},[(0,i._)("div",Yo,[Go,(0,i._)("input",{id:"asunto-objetivo",value:d.getAsuntoObjetivo(),readonly:""},null,8,Qo)]),(0,i._)("div",Ko,[Xo,(0,i._)("textarea",{id:"notas-objetivo",value:d.getNotasObjetivo(),rows:"4",style:{resize:"both"},readonly:""},null,8,et)]),(0,i._)("div",at,[ot,(0,i.wy)((0,i._)("input",{id:"asunto-realizado","onUpdate:modelValue":a[0]||(a[0]=e=>n.formulario.asunto=e)},null,512),[[t.nr,n.formulario.asunto]])]),(0,i._)("div",tt,[it,(0,i.wy)((0,i._)("textarea",{id:"notas-realizadas","onUpdate:modelValue":a[1]||(a[1]=e=>n.formulario.notas=e),rows:"4",style:{resize:"both"}},null,512),[[t.nr,n.formulario.notas]])]),1===d.getPasoAccionAutomatica?((0,i.wg)(),(0,i.iD)("div",ct,[rt,(0,i.wy)((0,i._)("select",{id:"conocio-select","onUpdate:modelValue":a[2]||(a[2]=e=>n.formulario.conocio=e),required:""},ut,512),[[t.bM,n.formulario.conocio]])])):(0,i.kq)("",!0),1===d.getPasoAccionAutomatica?((0,i.wg)(),(0,i.iD)("div",pt,[ht,(0,i._)("label",null,[(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>n.formulario.personaDecision=e),type:"radio",value:"1",required:""},null,512),[[t.G2,n.formulario.personaDecision]]),(0,i.Uk)(" Si ")]),mt,(0,i._)("label",null,[(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>n.formulario.personaDecision=e),type:"radio",value:"0"},null,512),[[t.G2,n.formulario.personaDecision]]),(0,i.Uk)(" No ")])])):(0,i.kq)("",!0),1===d.getPasoAccionAutomatica?((0,i.wg)(),(0,i.iD)("div",gt,[kt,(0,i.wy)((0,i._)("input",{id:"plazo-estimadoDias","onUpdate:modelValue":a[5]||(a[5]=e=>n.formulario.plazoEstimadoDias=e),type:"number",min:"1",max:"99999",required:""},null,512),[[t.nr,n.formulario.plazoEstimadoDias]])])):(0,i.kq)("",!0),2===d.getPasoAccionAutomatica?((0,i.wg)(),(0,i.iD)("div",bt,[ft,(0,i.wy)((0,i._)("input",{id:"guardarRi","onUpdate:modelValue":a[6]||(a[6]=e=>n.formulario.ri=e),type:"number",min:"1",max:"999999999999",required:""},null,512),[[t.nr,n.formulario.ri]])])):(0,i.kq)("",!0),6===d.getPasoAccionAutomatica?((0,i.wg)(),(0,i.iD)("div",vt,[(0,i._)("div",null,[Ct,(0,i._)("label",null,[(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":a[7]||(a[7]=e=>n.formulario.formaPago=e),type:"radio",value:"transferencia",required:""},null,512),[[t.G2,n.formulario.formaPago]]),(0,i.Uk)(" Transferencia ")]),At,(0,i._)("label",null,[(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":a[8]||(a[8]=e=>n.formulario.formaPago=e),type:"radio",value:"financiacion"},null,512),[[t.G2,n.formulario.formaPago]]),(0,i.Uk)(" Financiación ")])]),(0,i._)("div",yt,[wt,(0,i.wy)((0,i._)("input",{id:"fechaInstalacionProvisional","onUpdate:modelValue":a[9]||(a[9]=e=>n.formulario.fechaInstalacionProvisional=e),type:"date",required:""},null,512),[[t.nr,n.formulario.fechaInstalacionProvisional]])])])):(0,i.kq)("",!0),(0,i._)("div",Ot,[St,_t,(0,i._)("button",{type:"button",class:"cancel-button",onClick:a[10]||(a[10]=(...e)=>d.cancelForm&&d.cancelForm(...e))}," Cancelar ")])],32)])}var xt={data(){return{formulario:{accionSeleccionada:"",emitidoORecibido:"emitir",asunto:"",notas:"",fecha:"",hora:"",ri:null,conocio:"internet",personaDecision:"",plazoEstimadoDias:1,formaPago:null,fechaInstalacionProvisional:null},accionSeleccionada:"llamada",emitidoORecibido:"",mostrarFormulario:!0,listaCorreos:["prueba"],comercialAsignado:""}},computed:{getPasoAccionAutomatica(){const e=localStorage.getItem("accionOportunidadVentaSeleccionada"),a=JSON.parse(e),o=a[0].pasoAutomatica;return o}},created(){},methods:{getEmpresa(){const e=localStorage.getItem("accionOportunidadVentaSeleccionada"),a=JSON.parse(e),o=a[0].empresaOportunidad;return o},getAsuntoObjetivo(){const e=localStorage.getItem("accionOportunidadVentaSeleccionada"),a=JSON.parse(e),o=a[0].asuntoAccionObjetivo;return o},getNotasObjetivo(){const e=localStorage.getItem("accionOportunidadVentaSeleccionada"),a=JSON.parse(e),o=a[0].notasAccionObjetivo;return o},getIdOportunidad(){const e=localStorage.getItem("accionOportunidadVentaSeleccionada"),a=JSON.parse(e),o=a[0].idOportunidad;return parseInt(o)},getMiId(){const e=localStorage.getItem("id"),a=JSON.parse(e);return a},getAccionObjetivo(){const e=localStorage.getItem("accionOportunidadVentaSeleccionada"),a=JSON.parse(e),o=a[0].accionObjetivo;return o},getIdAccionOportunidad(){const e=localStorage.getItem("accionOportunidadVentaSeleccionada"),a=JSON.parse(e),o=a[0].idAccion;return parseInt(o)},getEmitidoORecibidoObjetivo(){const e=localStorage.getItem("accionOportunidadVentaSeleccionada"),a=JSON.parse(e),o=a[0].emitidoORecibidoAccionObjetivo;return parseInt(o)},async getIdDeCorreo(e){try{const a=await m.Z.post("/getIdFromCorreo",{correo:e}),{message:o}=a.data,t=o;return t}catch(a){return console.error("Error al obtener el ID del correo:",a),alert("Ha ocurrido un error al obtener el ID del correo"),null}},async agendarAccionAutomaticaPaso2(){const e=await this.getMiId(),a=await this.getIdOportunidad(),o={idCorreo:e,idOportunidad:a};try{const e=await m.Z.post("/agendarAccionAutomatica2",o),{message:a}=e.data;console.log(a),alert("Se ha generado la segunda acción automática para esta oportunidad de venta.\nAcción=> Enviar correo informativo EUREKA")}catch(t){alert("Ha ocurrido un error al generar la acción automática 2 para esta oportunidad de venta")}},async agendarAccionAutomaticaPaso3(){const e=await this.getMiId(),a=await this.getIdOportunidad(),o={idCorreo:e,idOportunidad:a};try{const e=await m.Z.post("/agendarAccionAutomatica3",o),{message:a}=e.data;console.log(a),alert("Se ha generado la tercera acción automática para esta oportunidad de venta.\nAcción=> LLamada para coonocer si el cliente entendió la información")}catch(t){alert("Ha ocurrido un error al generar la acción automática 3 para esta oportunidad de venta")}},async agendarAccionAutomaticaPaso4(){const e=await this.getMiId(),a=await this.getIdOportunidad(),o={idCorreo:e,idOportunidad:a};try{const e=await m.Z.post("/agendarAccionAutomatica4",o),{message:a}=e.data;console.log(a),alert("Se ha generado la cuarta acción automática para esta oportunidad de venta.\nAcción=> MAIL TIPO: enviar DEMO del software sin TPV")}catch(t){alert("Ha ocurrido un error al generar la acción automática 4 para esta oportunidad de venta")}},async agendarAccionAutomaticaPaso5(){const e=await this.getMiId(),a=await this.getIdOportunidad(),o={idCorreo:e,idOportunidad:a};try{const e=await m.Z.post("/agendarAccionAutomatica5",o),{message:a}=e.data;console.log(a),alert("Se ha generado la quinta acción automática para esta oportunidad de venta.\nAcción=> LLamada: Conocer si ha entendido la DEMO y si no explicarsela")}catch(t){alert("Ha ocurrido un error al generar la acción automática 5 para esta oportunidad de venta")}},async agendarAccionAutomaticaPaso6(){const e=await this.getMiId(),a=await this.getIdOportunidad(),o={idCorreo:e,idOportunidad:a};try{const e=await m.Z.post("/agendarAccionAutomatica6",o),{message:a}=e.data;console.log(a),alert("Se ha generado la sexta acción automática para esta oportunidad de venta.\nAcción=> LLamada: Cerrar la operación de venta")}catch(t){alert("Ha ocurrido un error al generar la acción automática 6 para esta oportunidad de venta")}},async completarAccionAutomaticaPaso1(){const e=await this.getIdOportunidad(),a=this.formulario.conocio,o=this.formulario.personaDecision,t=this.formulario.plazoEstimadoDias,i={idOportunidad:e,conocio:a,personaDecision:o,plazoEstimadoDias:t};try{const e=await m.Z.post("/completarAccionAutomaticaPaso1",i),{message:a}=e.data;console.log(a)}catch(c){alert("Ha ocurrido un error al completar la acción automática 1 para esta oportunidad de venta")}},async completarAccionAutomaticaPaso6(){const e=await this.getIdOportunidad(),a=new Date(this.formulario.fechaInstalacionProvisional),o=a.getDate(),t=a.getMonth()+1,i=a.getFullYear(),c=this.formulario.formaPago,r={idOportunidad:e,fechaInstalacionProvisionalDia:o,fechaInstalacionProvisionalMes:t,"fechaInstalacionProvisionalAño":i,formaPago:c};try{const e=await m.Z.post("/completarAccionAutomaticaPaso6",r),{message:a}=e.data;console.log(a)}catch(n){alert("Ha ocurrido un error al completar la acción automática 6 para esta oportunidad de venta")}},async completarAccion(){const e=new Date,a=e.getDate(),o=e.getMonth()+1,t=e.getFullYear(),i=e.getHours(),c=e.getMinutes(),r={idAccionOportunidad:this.getIdAccionOportunidad(),idAutor:this.getMiId(),accionRealizada:this.getAccionObjetivo(),emitidoORecibidoRealizada:this.getEmitidoORecibidoObjetivo(),asuntoRealizada:this.formulario.asunto,notasRealizada:this.formulario.notas,riRealizada:this.formulario.ri,fechaDiaRealizada:a,fechaMesRealizada:o,"fechaAñoRealizada":t,horaRealizada:i,minutoRealizada:c,completada:1};try{const e=await m.Z.post("/completarAccionOportunidad",r),{message:a}=e.data;console.log(a),alert("Acción completada correctamente"),1===this.getPasoAccionAutomatica?(await this.completarAccionAutomaticaPaso1(),await this.agendarAccionAutomaticaPaso2()):2===this.getPasoAccionAutomatica?await this.agendarAccionAutomaticaPaso3():3===this.getPasoAccionAutomatica?await this.agendarAccionAutomaticaPaso4():4===this.getPasoAccionAutomatica?await this.agendarAccionAutomaticaPaso5():5===this.getPasoAccionAutomatica?await this.agendarAccionAutomaticaPaso6():6===this.getPasoAccionAutomatica&&await this.completarAccionAutomaticaPaso6()}catch(n){console.error("Error al completar la acción:",n),alert("Ha ocurrido un error al completar la acción")}},limpiarFormulario(){this.formulario={accionSeleccionada:"",emitidoORecibido:"",asunto:"",notas:"",fecha:"",hora:"",ri:0}},async submitForm(){await this.completarAccion(),this.limpiarFormulario(),this.$emit("cancel")},cancelForm(){this.limpiarFormulario(),this.$emit("cancel")}}};const It=(0,k.Z)(xt,[["render",Dt],["__scopeId","data-v-a50b5342"]]);var Et=It,Ft={components:{FullCalendar:Ho.Z,sideBarCompletarAccionOportunidadVenta:Et},props:{eventsData:{type:Array,default:()=>[]}},data(){return{showSideBarCompletarAccion:!1,calendarOptions:{locale:$o.Z,plugins:[Bo.Z,Zo.ZP],initialView:"dayGridWeek",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,dayGridWeek,dayGridDay"},eventClick:e=>{this.calendarEventClick(e)},events:[]}}},async mounted(){await this.obtenerEventos()},methods:{async guardarAccionOportunidadVenta(e){const a=e.event.extendedProps.idAccionOportunidadVenta,o=await m.Z.post("/getAccionOportunidadVentaFromId",{idAccionOportunidadVenta:a}),{message:t}=o.data;let i=JSON.parse(t);const c=JSON.stringify(i);localStorage.setItem("accionOportunidadVentaSeleccionada",c)},getMiId(){const e=localStorage.getItem("id"),a=JSON.parse(e);return a},async calendarEventClick(e){await this.guardarAccionOportunidadVenta(e),this.showSideBarCompletarAccion=!0},formatEventsData(e){return e.map((e=>({title:e.empresa+"\n"+e.asuntoObjetivo,start:new Date(e.fechaAñoObjetivo,e.fechaMesObjetivo-1,e.fechaDiaObjetivo,e.horaObjetivo,e.minutoobjetivo),extendedProps:{idAccionOportunidadVenta:e.idAccionOportunidadVenta,notasObjetivo:e.notasObjetivo,tipo:"oportunidadVenta"}})))},async obtenerEventos(){try{const e="\n  SELECT\n    ao.id AS idAccionOportunidadVenta,\n    o.id AS idOportunidad,\n    ao.accionobjetivo AS accionObjetivo,\n    ao.asuntoobjetivo AS asuntoObjetivo,\n    ao.notasobjetivo AS notasObjetivo,\n    ao.fechadiaobjetivo AS fechaDiaObjetivo,\n    ao.fechamesobjetivo AS fechaMesObjetivo,\n    ao.fechaañoobjetivo AS fechaAñoObjetivo,\n    ao.horaobjetivo AS horaObjetivo,\n    ao.minutoobjetivo AS minutoobjetivo,\n    ao.completada AS completada,\n    o.empresa AS empresa\n  FROM\n    accionesOportunidades AS ao\n  JOIN\n    oportunidades AS o ON ao.idOportunidad = o.id\n  JOIN\n    usuarios AS u ON o.idComercialAsignado = u.id\n  WHERE\n    completada = ? AND u.id = ?",a=[0,this.getMiId()],o=await m.Z.post("/query",{query:e,parametros:a}),t=o.data;if(t&&t.message){const e=JSON.parse(t.message);Array.isArray(e)?this.calendarOptions.events=this.formatEventsData(e):console.error("Los datos obtenidos no son válidos:",e)}else console.error("Respuesta inválida:",t)}catch(e){console.error("Error al obtener eventos:",e)}},hideSideBarCompletarAccion(){this.showSideBarCompletarAccion=!1}}};const Pt=(0,k.Z)(Ft,[["render",Uo]]);var qt=Pt,zt={components:{calendarioAgenda:qt},created(){this.comprobarCorreo()},methods:{async comprobarCorreo(){const e=this.$store.state.correo;null===e&&this.$router.push({name:"LoginView"})}}};const Nt=(0,k.Z)(zt,[["render",Mo]]);var Rt=Nt;const jt=e=>((0,i.dD)("data-v-36aee114"),e=e(),(0,i.Cn)(),e),Vt=jt((()=>(0,i._)("hr",null,null,-1))),Tt=jt((()=>(0,i._)("label",{for:"selectTablaAcciones"},"Filtros para",-1))),Mt=jt((()=>(0,i._)("option",{value:"oportunidades"}," Acciones sobre oportunidades de venta ",-1))),Lt=jt((()=>(0,i._)("option",{value:"clientes"}," Clientes ",-1))),Ut=jt((()=>(0,i._)("option",{value:"contactos"}," Contactos ",-1))),Ht=jt((()=>(0,i._)("option",{value:"listaNegra"}," Lista negra ",-1))),Bt=[Mt,Lt,Ut,Ht],Zt=jt((()=>(0,i._)("hr",null,null,-1))),$t={key:0},Jt={key:1},Wt={key:2};function Yt(e,a,o,r,n,d){const l=(0,i.up)("lista-acciones-oportunidades"),s=(0,i.up)("lista-negra"),u=(0,i.up)("lista-clientes");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i._)("h1",null,(0,c.zw)(e.pageTitle),1),Vt,Tt,(0,i.wy)((0,i._)("select",{id:"selectTablaAcciones","onUpdate:modelValue":a[0]||(a[0]=e=>n.selectTablaAcciones=e),name:"selectTablaAcciones"},Bt,512),[[t.bM,n.selectTablaAcciones]]),Zt,"oportunidades"===n.selectTablaAcciones?((0,i.wg)(),(0,i.iD)("div",$t,[(0,i.Wm)(l)])):(0,i.kq)("",!0),"listaNegra"===n.selectTablaAcciones?((0,i.wg)(),(0,i.iD)("div",Jt,[(0,i.Wm)(s)])):(0,i.kq)("",!0),"clientes"===n.selectTablaAcciones?((0,i.wg)(),(0,i.iD)("div",Wt,[(0,i.Wm)(u)])):(0,i.kq)("",!0)])}const Gt=e=>((0,i.dD)("data-v-2ed90f76"),e=e(),(0,i.Cn)(),e),Qt=Gt((()=>(0,i._)("hr",null,null,-1))),Kt=Gt((()=>(0,i._)("hr",null,null,-1))),Xt=(0,i.uE)('<fieldset name="fieldsetMostrarColumnasOportunidades" data-v-2ed90f76><h4 style="color:blue;" data-v-2ed90f76> Mostrar columnas </h4><br data-v-2ed90f76><div class="checkbox-container" data-v-2ed90f76><label data-v-2ed90f76><input id="checkIdAccion" type="checkbox" name="checkIdAccion" checked data-v-2ed90f76> Id </label><label data-v-2ed90f76><input id="checkIdOportunidad" type="checkbox" name="checkIdOportunidad" data-v-2ed90f76> ID Oportunidad </label><label data-v-2ed90f76><input id="checkProductoOportunidad" type="checkbox" name="checkProductoOportunidad" checked data-v-2ed90f76> Producto </label><label data-v-2ed90f76><input id="checkEmpresaOportunidad" type="checkbox" name="checkEmpresaOportunidad" checked data-v-2ed90f76> Empresa </label><label data-v-2ed90f76><input id="checkIdAutorAccion" type="checkbox" name="checkIdAutorAccion" data-v-2ed90f76> ID Autor </label><label data-v-2ed90f76><input id="checkAutorAccion" type="checkbox" name="checkAutorAccion" checked data-v-2ed90f76> Autor </label><label data-v-2ed90f76><input id="checkComercialAsignado" type="checkbox" name="checkComercialAsignado" checked data-v-2ed90f76> Comercial asignado </label><label data-v-2ed90f76><input id="checkAccionObjetivo" type="checkbox" name="checkAccionObjetivo" data-v-2ed90f76> Acción Objetivo </label><label data-v-2ed90f76><input id="checkAccionRealizada" type="checkbox" name="checkAccionRealizada" checked data-v-2ed90f76> Acción Realizada </label></div><div class="checkbox-container" data-v-2ed90f76><label data-v-2ed90f76><input id="checkEmitidoORecibidoAccionOportunidad" type="checkbox" name="checkEmitidoORecibidoAccionOportunidad" checked data-v-2ed90f76> Emitido o Recibido </label><label data-v-2ed90f76><input id="checkAsuntoAccionOportunidadObjetivo" type="checkbox" name="checkAsuntoAccionOportunidadObjetivo" data-v-2ed90f76> Asunto Objetivo </label><label data-v-2ed90f76><input id="checkAsuntoAccionOportunidadRealizada" type="checkbox" name="checkAsuntoAccionOportunidadRealizada" checked data-v-2ed90f76> Asunto realizada </label><label data-v-2ed90f76><input id="checkNotasAccionOportunidadObjetivo" type="checkbox" name="checkNotasAccionOportunidadObjetivo" data-v-2ed90f76> Notas objetivo </label><label data-v-2ed90f76><input id="checkNotasAccionOportunidadRealizada" type="checkbox" name="checkNotasAccionOportunidadRealizada" checked data-v-2ed90f76> Notas realizada </label><label data-v-2ed90f76><input id="checkRiAccionOportunidad" type="checkbox" name="checkRiAccionOportunidad" data-v-2ed90f76> RI </label><label data-v-2ed90f76><input id="checkFechaOportunidad" type="checkbox" name="checkFechaOportunidad" checked data-v-2ed90f76> Fecha creación Oportunidad </label><label data-v-2ed90f76><input id="checkFechaAccionObjetivo" type="checkbox" name="checkFechaAccionObjetivo" data-v-2ed90f76> Fecha acción objetivo </label><label data-v-2ed90f76><input id="checkFechaAccionRealizada" type="checkbox" name="checkFechaAccionRealizada" checked data-v-2ed90f76> Fecha acción realizada </label><label data-v-2ed90f76><input id="checkHoraAccion" type="checkbox" name="checkHoraAccion" checked data-v-2ed90f76> Hora Acción </label><label data-v-2ed90f76><input id="checkCompletada" type="checkbox" name="checkCompletada" checked data-v-2ed90f76> Completada </label></div></fieldset>',1),ei={name:"fieldSetFiltrosOportunidad"},ai=(0,i.uE)('<h4 style="color:blue;" data-v-2ed90f76> Filtros </h4><input id="txtIdAccion" type="text" placeholder="ID acción" data-v-2ed90f76><input id="txtIdOportunidad" type="text" placeholder="ID Oportunidad" data-v-2ed90f76><input id="txtProductoOportunidad" type="text" placeholder="Producto" data-v-2ed90f76><input id="txtEmpresaOportunidad" type="text" placeholder="Empresa" data-v-2ed90f76>',5),oi={key:0,id:"txtAutorAccion",type:"text",placeholder:"Autor de la acción"},ti={key:1,id:"txtComercialAsignado",type:"text",placeholder:"Comercial asignado"},ii=Gt((()=>(0,i._)("label",{for:"selectFiltroAccionOportunidad"},"Acción",-1))),ci=(0,i.uE)('<option value="llamada" data-v-2ed90f76> Llamada telefónica </option><option value="correo" data-v-2ed90f76> Correo electrónico </option><option value="whatsapp" data-v-2ed90f76> WhatsApp </option><option value="visita" data-v-2ed90f76> Visita </option><option value="presupuesto" data-v-2ed90f76> Presupuesto terminado </option><option value="venta" data-v-2ed90f76> Venta realizada </option><option value="contacto" data-v-2ed90f76> Pasar a contacto </option><option value="otro" data-v-2ed90f76> Otro </option><option value="todas" data-v-2ed90f76> Todas </option>',9),ri=[ci],ni=Gt((()=>(0,i._)("label",{for:"opcionEmitidoORecibido"},"Emitido o Recibido",-1))),di=Gt((()=>(0,i._)("option",{value:"todas",selected:""}," Todas ",-1))),li=Gt((()=>(0,i._)("option",{value:"recibido"}," Recibido ",-1))),si=Gt((()=>(0,i._)("option",{value:"emitido"}," Emitido ",-1))),ui=[di,li,si],pi=Gt((()=>(0,i._)("input",{id:"txtAsuntoAccionOportunidad",type:"text",placeholder:"Asunto"},null,-1))),hi=Gt((()=>(0,i._)("input",{id:"txtNotasAccionOportunidad",type:"text",placeholder:"Notas"},null,-1))),mi=Gt((()=>(0,i._)("input",{id:"txtRiAccionOportunidad",type:"text",placeholder:"RI"},null,-1))),gi=Gt((()=>(0,i._)("label",{for:"selectFiltroCompletadaAccionOportunidad"},"Completada",-1))),ki=Gt((()=>(0,i._)("option",{value:"todas",selected:""}," Todas ",-1))),bi=Gt((()=>(0,i._)("option",{value:"si"}," Si ",-1))),fi=Gt((()=>(0,i._)("option",{value:"no"}," No ",-1))),vi=[ki,bi,fi],Ci=Gt((()=>(0,i._)("hr",null,null,-1))),Ai=Gt((()=>(0,i._)("label",{for:"txtFechaDesdeAccionOportunidad"},"Fecha Desde:",-1))),yi=Gt((()=>(0,i._)("label",{for:"txtFechaHastaAccionOportunidad"},"Fecha Hasta:",-1))),wi=Gt((()=>(0,i._)("hr",null,null,-1))),Oi=Gt((()=>(0,i._)("label",{for:"order-select"},"Ordenar por ",-1))),Si=Gt((()=>(0,i._)("option",{value:"fecha_desc"}," Fecha acción (más nuevo a más antiguo) ",-1))),_i=Gt((()=>(0,i._)("option",{value:"fecha_asc"}," Fecha acción (más antiguo a más nuevo) ",-1))),Di=Gt((()=>(0,i._)("option",{value:"producto"}," Producto ",-1))),xi=Gt((()=>(0,i._)("option",{value:"empresa"}," Empresa ",-1))),Ii={key:0,value:"autor"},Ei=Gt((()=>(0,i._)("option",{value:"accion"}," Acción ",-1))),Fi=Gt((()=>(0,i._)("option",{value:"ri"}," RI ",-1))),Pi=Gt((()=>(0,i._)("option",{value:"completada"}," Completada ",-1))),qi={class:"custom-table"},zi={key:0},Ni={key:1},Ri={key:2},ji={key:3},Vi={key:4},Ti={key:5},Mi={key:6},Li={key:7},Ui={key:8},Hi={key:9},Bi={key:10},Zi={key:11},$i={key:12},Ji={key:13},Wi={key:14},Yi={key:15},Gi={key:16},Qi={key:17},Ki={key:18},Xi={key:19},ec={key:0},ac={key:1},oc={key:2},tc={key:3},ic={key:4},cc={key:5},rc={key:6},nc={key:7},dc={key:8},lc={key:9},sc={key:10},uc={key:11},pc={key:12},hc={key:13},mc={key:14},gc={key:15},kc={key:16},bc={key:17},fc={key:18},vc={key:19};function Cc(e,a,o,r,n,d){return(0,i.wg)(),(0,i.iD)("div",null,[Qt,Kt,(0,i._)("div",null,[Xt,(0,i._)("fieldset",ei,[ai,e.$store.state.esAdmin?((0,i.wg)(),(0,i.iD)("input",oi)):(0,i.kq)("",!0),e.$store.state.esAdmin?((0,i.wg)(),(0,i.iD)("input",ti)):(0,i.kq)("",!0),ii,(0,i.wy)((0,i._)("select",{id:"selectFiltroAccionOportunidad","onUpdate:modelValue":a[0]||(a[0]=e=>n.accion=e),name:"selectFiltroAccionOportunidad"},ri,512),[[t.bM,n.accion]]),ni,(0,i.wy)((0,i._)("select",{id:"selectEmitidoORecibido","onUpdate:modelValue":a[1]||(a[1]=e=>n.opcionEmitidoORecibido=e),name:"selectEmitidoORecibido"},ui,512),[[t.bM,n.opcionEmitidoORecibido]]),pi,hi,mi,gi,(0,i.wy)((0,i._)("select",{id:"selectFiltroCompletadaAccionOportunidad","onUpdate:modelValue":a[2]||(a[2]=e=>n.completada=e),name:"selectFiltroCompletadaAccionOportunidad"},vi,512),[[t.bM,n.completada]]),Ci,(0,i._)("div",null,[Ai,(0,i.wy)((0,i._)("input",{id:"txtFechaDesdeAccionOportunidad","onUpdate:modelValue":a[3]||(a[3]=e=>n.fechaDesde=e),type:"date"},null,512),[[t.nr,n.fechaDesde]])]),(0,i._)("div",null,[yi,(0,i.wy)((0,i._)("input",{id:"txtFechaHastaAccionOportunidad","onUpdate:modelValue":a[4]||(a[4]=e=>n.fechaHasta=e),type:"date"},null,512),[[t.nr,n.fechaHasta]])]),wi,Oi,(0,i.wy)((0,i._)("select",{id:"order-select","onUpdate:modelValue":a[5]||(a[5]=e=>n.selectedOrder=e)},[Si,_i,Di,xi,e.$store.state.esAdmin?((0,i.wg)(),(0,i.iD)("option",Ii," Autor de la acción ")):(0,i.kq)("",!0),Ei,Fi,Pi],512),[[t.bM,n.selectedOrder]]),(0,i._)("button",{id:"btn_ejecutar_consulta",onClick:a[6]||(a[6]=(...e)=>d.ejecutarConsulta&&d.ejecutarConsulta(...e))}," Ejecutar consulta "),(0,i._)("button",{class:"botonExportar",onClick:a[7]||(a[7]=(...e)=>d.exportarCSV&&d.exportarCSV(...e))}," Exportar tabla a CSV ")])]),(0,i._)("div",null,[(0,i._)("table",qi,[(0,i._)("thead",null,[(0,i._)("tr",null,[d.isColumnSelected("checkIdAccion")?((0,i.wg)(),(0,i.iD)("th",zi," ID ")):(0,i.kq)("",!0),d.isColumnSelected("checkIdOportunidad")?((0,i.wg)(),(0,i.iD)("th",Ni," ID oportunidad ")):(0,i.kq)("",!0),d.isColumnSelected("checkProductoOportunidad")?((0,i.wg)(),(0,i.iD)("th",Ri," Producto ")):(0,i.kq)("",!0),d.isColumnSelected("checkEmpresaOportunidad")?((0,i.wg)(),(0,i.iD)("th",ji," Empresa ")):(0,i.kq)("",!0),d.isColumnSelected("checkIdAutorAccion")?((0,i.wg)(),(0,i.iD)("th",Vi," ID Autor ")):(0,i.kq)("",!0),d.isColumnSelected("checkAutorAccion")?((0,i.wg)(),(0,i.iD)("th",Ti," Autor ")):(0,i.kq)("",!0),d.isColumnSelected("checkComercialAsignado")?((0,i.wg)(),(0,i.iD)("th",Mi," Comercial asignado ")):(0,i.kq)("",!0),d.isColumnSelected("checkAccionObjetivo")?((0,i.wg)(),(0,i.iD)("th",Li," Accion Objetivo ")):(0,i.kq)("",!0),d.isColumnSelected("checkAccionRealizada")?((0,i.wg)(),(0,i.iD)("th",Ui," Accion Realizada ")):(0,i.kq)("",!0),d.isColumnSelected("checkEmitidoORecibidoAccionOportunidad")?((0,i.wg)(),(0,i.iD)("th",Hi," Emitido o recibido ")):(0,i.kq)("",!0),d.isColumnSelected("checkAsuntoAccionOportunidadObjetivo")?((0,i.wg)(),(0,i.iD)("th",Bi," Asunto Objetivo ")):(0,i.kq)("",!0),d.isColumnSelected("checkAsuntoAccionOportunidadRealizada")?((0,i.wg)(),(0,i.iD)("th",Zi," Asunto Realizada ")):(0,i.kq)("",!0),d.isColumnSelected("checkNotasAccionOportunidadObjetivo")?((0,i.wg)(),(0,i.iD)("th",$i," Notas Objetivo ")):(0,i.kq)("",!0),d.isColumnSelected("checkNotasAccionOportunidadRealizada")?((0,i.wg)(),(0,i.iD)("th",Ji," Notas Realizada ")):(0,i.kq)("",!0),d.isColumnSelected("checkRiAccionOportunidad")?((0,i.wg)(),(0,i.iD)("th",Wi," RI ")):(0,i.kq)("",!0),d.isColumnSelected("checkFechaOportunidad")?((0,i.wg)(),(0,i.iD)("th",Yi," Fecha Creación Oportunidad ")):(0,i.kq)("",!0),d.isColumnSelected("checkFechaAccionObjetivo")?((0,i.wg)(),(0,i.iD)("th",Gi," Fecha acción objetivo ")):(0,i.kq)("",!0),d.isColumnSelected("checkFechaAccionRealizada")?((0,i.wg)(),(0,i.iD)("th",Qi," Fecha acción realizada ")):(0,i.kq)("",!0),d.isColumnSelected("checkHoraAccion")?((0,i.wg)(),(0,i.iD)("th",Ki," Hora accion realizada ")):(0,i.kq)("",!0),d.isColumnSelected("checkCompletada")?((0,i.wg)(),(0,i.iD)("th",Xi," Completada ")):(0,i.kq)("",!0)])]),(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.resultados,(e=>((0,i.wg)(),(0,i.iD)("tr",{key:e.idAccion},[d.isColumnSelected("checkIdAccion")?((0,i.wg)(),(0,i.iD)("td",ec,(0,c.zw)(e.idAccion),1)):(0,i.kq)("",!0),d.isColumnSelected("checkIdOportunidad")?((0,i.wg)(),(0,i.iD)("td",ac,(0,c.zw)(e.idOportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkProductoOportunidad")?((0,i.wg)(),(0,i.iD)("td",oc,(0,c.zw)(e.productoOportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkEmpresaOportunidad")?((0,i.wg)(),(0,i.iD)("td",tc,(0,c.zw)(e.empresaOportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkIdAutorAccion")?((0,i.wg)(),(0,i.iD)("td",ic,(0,c.zw)(e.idAutor),1)):(0,i.kq)("",!0),d.isColumnSelected("checkAutorAccion")?((0,i.wg)(),(0,i.iD)("td",cc,(0,c.zw)(e.AutorAccion),1)):(0,i.kq)("",!0),d.isColumnSelected("checkComercialAsignado")?((0,i.wg)(),(0,i.iD)("td",rc,(0,c.zw)(e.comercialAsignado),1)):(0,i.kq)("",!0),d.isColumnSelected("checkAccionObjetivo")?((0,i.wg)(),(0,i.iD)("td",nc,(0,c.zw)(e.accionObjetivo),1)):(0,i.kq)("",!0),d.isColumnSelected("checkAccionRealizada")?((0,i.wg)(),(0,i.iD)("td",dc,(0,c.zw)(e.accion),1)):(0,i.kq)("",!0),d.isColumnSelected("checkEmitidoORecibidoAccionOportunidad")?((0,i.wg)(),(0,i.iD)("td",lc,(0,c.zw)(e.emitidoORecibidoAccion),1)):(0,i.kq)("",!0),d.isColumnSelected("checkAsuntoAccionOportunidadObjetivo")?((0,i.wg)(),(0,i.iD)("td",sc,(0,c.zw)(e.asuntoAccionObjetivo),1)):(0,i.kq)("",!0),d.isColumnSelected("checkAsuntoAccionOportunidadRealizada")?((0,i.wg)(),(0,i.iD)("td",uc,(0,c.zw)(e.asuntoAccion),1)):(0,i.kq)("",!0),d.isColumnSelected("checkNotasAccionOportunidadObjetivo")?((0,i.wg)(),(0,i.iD)("td",pc,(0,c.zw)(e.notasAccionObjetivo),1)):(0,i.kq)("",!0),d.isColumnSelected("checkNotasAccionOportunidadRealizada")?((0,i.wg)(),(0,i.iD)("td",hc,(0,c.zw)(e.notasAccion),1)):(0,i.kq)("",!0),d.isColumnSelected("checkRiAccionOportunidad")?((0,i.wg)(),(0,i.iD)("td",mc,(0,c.zw)(e.riAccion),1)):(0,i.kq)("",!0),d.isColumnSelected("checkFechaOportunidad")?((0,i.wg)(),(0,i.iD)("td",gc,(0,c.zw)(d.formatFecha(e.fechaDiaOportunidad,e.fechaMesOportunidad,e.fechaAñoOportunidad)),1)):(0,i.kq)("",!0),d.isColumnSelected("checkFechaAccionObjetivo")?((0,i.wg)(),(0,i.iD)("td",kc,(0,c.zw)(d.formatFecha(e.fechaDiaAccionObjetivo,e.fechaMesAccionObjetivo,e.fechaAñoAccionObjetivo)),1)):(0,i.kq)("",!0),d.isColumnSelected("checkFechaAccionRealizada")?((0,i.wg)(),(0,i.iD)("td",bc,(0,c.zw)(d.formatFecha(e.fechaDiaAccion,e.fechaMesAccion,e.fechaAñoAccion)),1)):(0,i.kq)("",!0),d.isColumnSelected("checkHoraAccion")?((0,i.wg)(),(0,i.iD)("td",fc,(0,c.zw)(d.formatHora(e.horaAccion,e.minutoAccion)),1)):(0,i.kq)("",!0),d.isColumnSelected("checkCompletada")?((0,i.wg)(),(0,i.iD)("td",vc,(0,c.zw)(e.completada),1)):(0,i.kq)("",!0)])))),128))])])])])}function Ac(e){try{const a=localStorage.getItem(e);return JSON.parse(a)}catch(a){return console.error(a),null}}var yc={components:{},data(){return{usuarios:[],query:"",parametrosQuery:[],selectedOrder:"fecha_desc",fechaDesde:null,fechaHasta:null,accion:"todas",completada:"todas",resultados:[],opcionEmitidoORecibido:"todas"}},computed:{},created(){this.comprobarCorreo()},methods:{formatFecha(e,a,o){if(null===e||null===a||null===o||isNaN(e)||isNaN(a)||isNaN(o))return"";const t=new Date(o,a-1,e);return t.toLocaleDateString("es-ES")},formatHora(e,a){return e=Math.max(0,Math.min(23,e)),a=Math.max(0,Math.min(59,a)),a<10&&(a="0"+a),e+":"+a},async comprobarCorreo(){const e=this.$store.state.correo;null===e&&this.$router.push({name:"LoginView"})},isColumnSelected(e){try{const a=document.getElementById(e);return a.checked}catch(a){return!0}},getMiId(){const e=localStorage.getItem("id"),a=JSON.parse(e);return a},async ejecutarConsulta(){try{const e=document.getElementById("txtIdAccion").value.trim(),a=document.getElementById("txtIdOportunidad").value.trim(),o=document.getElementById("txtProductoOportunidad").value.trim(),t=document.getElementById("txtEmpresaOportunidad").value.trim();let i="";this.$store.state.esAdmin&&(i=document.getElementById("txtAutorAccion").value.trim());let c=Ac("usuario");this.$store.state.esAdmin&&(c=document.getElementById("txtComercialAsignado").value.trim());const r=this.accion,n=document.getElementById("txtAsuntoAccionOportunidad").value.trim(),d=document.getElementById("txtNotasAccionOportunidad").value.trim(),l=document.getElementById("txtRiAccionOportunidad").value.trim(),s=this.completada,u=this.fechaDesde,p=this.fechaHasta,h=this.opcionEmitidoORecibido,g=this.selectedOrder,k=await m.Z.post("/getListaAccionesOportunidades",{fechaDesde:u,fechaHasta:p,txtIdAccion:e,txtIdOportunidad:a,txtProducto:o,txtEmpresa:t,txtAutor:i,txtComercialAsignado:c,accionEscogida:r,opcionEmitidoORecibido:h,txtAsunto:n,txtNotas:d,txtRi:l,completadaEscogida:s,selectedOrder:g}),{message:b}=k.data;this.usuarios=JSON.parse(b),this.resultados=JSON.parse(k.data.message)}catch(e){console.error(e),this.message="Error al obtener los usuarios"}},exportarCSV(){const e=[],a=this.obtenerEncabezadosSeleccionados();e.push(a),this.usuarios.forEach((a=>{const o=this.obtenerDatosFila(a);e.push(o)}));let o="";e.forEach((e=>{o+=e.map((e=>`"${e}"`)).join(",")+"\n"}));const t=new Blob([o],{type:"text/csv;charset=utf-8;"}),i=window.URL.createObjectURL(t),c=document.createElement("a");c.setAttribute("href",i),c.setAttribute("download","tabla.csv"),c.style.display="none",document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(i)},obtenerEncabezadosSeleccionados(){const e=[];return this.isColumnSelected("checkIdAccion")&&e.push("ID"),this.isColumnSelected("checkIdOportunidad")&&e.push("ID Oportunidad"),this.isColumnSelected("checkProductoOportunidad")&&e.push("Producto"),this.isColumnSelected("checkEmpresaOportunidad")&&e.push("Empresa"),this.isColumnSelected("checkIdAutorAccion")&&e.push("ID Autor"),this.isColumnSelected("checkAutorAccion")&&e.push("Autor"),this.isColumnSelected("checkComercialAsignado")&&e.push("Comercial Asignado"),this.isColumnSelected("checkAccionObjetivo")&&e.push("Acción"),this.isColumnSelected("checkAccionRealizada")&&e.push("Acción realiazada"),this.isColumnSelected("checkEmitidoORecibidoAccionOportunidad")&&e.push("Emitido o Recibido"),this.isColumnSelected("checkAsuntoAccionOportunidadObjetivo")&&e.push("Asunto objetivo"),this.isColumnSelected("checkAsuntoAccionOportunidadRealizada")&&e.push("Asunto realizada"),this.isColumnSelected("checkNotasAccionOportunidadObjetivo")&&e.push("Notas objetivo"),this.isColumnSelected("checkNotasAccionOportunidadRealizada")&&e.push("Notas realizada"),this.isColumnSelected("checkRiAccionOportunidad")&&e.push("RI"),this.isColumnSelected("checkFechaOportunidad")&&e.push(" Fecha Creación Oportunidad "),this.isColumnSelected("checkFechaAccionObjetivo")&&e.push(" Fecha acciónn objetivo "),this.isColumnSelected("checkFechaAccionRealizada")&&e.push("Fecha acción"),this.isColumnSelected("checkHoraAccion")&&e.push("Hora acción"),this.isColumnSelected("checkCompletada")&&e.push("Completada"),e},obtenerDatosFila(e){const a=[];if(this.isColumnSelected("checkIdAccion")&&a.push(e.idAccion),this.isColumnSelected("checkIdOportunidad")&&a.push(e.idOportunidad),this.isColumnSelected("checkProductoOportunidad")&&a.push(e.productoOportunidad),this.isColumnSelected("checkEmpresaOportunidad")&&a.push(e.empresaOportunidad),this.isColumnSelected("checkIdAutorAccion")&&a.push(e.idAutor),this.isColumnSelected("checkAutorAccion")&&a.push(e.AutorAccion),this.isColumnSelected("checkComercialAsignado")&&a.push(e.comercialAsignado),this.isColumnSelected("checkAccionObjetivo")&&a.push(e.accionObjetivo),this.isColumnSelected("checkAccionRealizada")&&a.push(e.accion),this.isColumnSelected("checkEmitidoORecibidoAccionOportunidad")&&a.push(e.emitidoORecibidoAccion),this.isColumnSelected("checkAsuntoAccionOportunidadObjetivo")&&a.push(e.asuntoAccionObjetivo),this.isColumnSelected("checkAsuntoAccionOportunidadRealizada")&&a.push(e.asuntoAccion),this.isColumnSelected("checkNotasAccionOportunidadObjetivo")&&a.push(e.notasAccionObjetivo),this.isColumnSelected("checkNotasAccionOportunidadRealizado")&&a.push(e.notasAccion),this.isColumnSelected("checkRiAccionOportunidad")&&a.push(e.riAccion),this.isColumnSelected("checkFechaOportunidad")){const o=this.formatFecha(e.fechaDiaOportunidad,e.fechaMesOportunidad,e.fechaAñoOportunidad);a.push(o)}if(this.isColumnSelected("checkFechaAccionObjetivo")){const o=this.formatFecha(e.fechaDiaAccionObjetivo,e.fechaMesAccionObjetivo,e.fechaAñoAccionObjetivo);a.push(o)}if(this.isColumnSelected("checkFechaAccionRealizada")){const o=this.formatFecha(e.fechaDiaAccion,e.fechaMesAccion,e.fechaAñoAccion);a.push(o)}if(this.isColumnSelected("checkHoraAccion")){const o=e.horaAccion,t=e.minutoAccion,i=this.formatHora(o,t);a.push(i)}return this.isColumnSelected("checkCompletada")&&a.push(e.completada),a}}};const wc=(0,k.Z)(yc,[["render",Cc],["__scopeId","data-v-2ed90f76"]]);var Oc=wc;const Sc=e=>((0,i.dD)("data-v-03a8e4bc"),e=e(),(0,i.Cn)(),e),_c=Sc((()=>(0,i._)("hr",null,null,-1))),Dc=Sc((()=>(0,i._)("hr",null,null,-1))),xc=(0,i.uE)('<fieldset name="fieldsetMostrarColumnasOportunidades" data-v-03a8e4bc><h4 style="color:blue;" data-v-03a8e4bc> Mostrar columnas </h4><br data-v-03a8e4bc><div class="checkbox-container" data-v-03a8e4bc><label data-v-03a8e4bc><input id="checkIdListaNegra" type="checkbox" name="checkIdListaNegra" checked data-v-03a8e4bc> Id </label><label data-v-03a8e4bc><input id="checkIdOportunidad" type="checkbox" name="checkIdOportunidad" data-v-03a8e4bc> ID Oportunidad </label><label data-v-03a8e4bc><input id="checkProductoOportunidad" type="checkbox" name="checkProductoOportunidad" checked data-v-03a8e4bc> Producto </label><label data-v-03a8e4bc><input id="checkEmpresaOportunidad" type="checkbox" name="checkEmpresaOportunidad" checked data-v-03a8e4bc> Empresa </label><label data-v-03a8e4bc><input id="checkIdCreador" type="checkbox" name="checkIdCreador" data-v-03a8e4bc> ID Creador </label><label data-v-03a8e4bc><input id="checkCreador" type="checkbox" name="checkCreador" checked data-v-03a8e4bc> Creador </label><label data-v-03a8e4bc><input id="checkMotivo" type="checkbox" name="checkMotivo" checked data-v-03a8e4bc> Motivo </label><label data-v-03a8e4bc><input id="checkComercialAsignado" type="checkbox" name="checkComercialAsignado" checked data-v-03a8e4bc> Comercial asignado </label></div><div class="checkbox-container" data-v-03a8e4bc><label data-v-03a8e4bc><input id="checkFechaOportunidad" type="checkbox" name="checkFechaOportunidad" checked data-v-03a8e4bc> Fecha creación Oportunidad </label><label data-v-03a8e4bc><input id="checkFechaListaNegra" type="checkbox" name="checkFechaListaNegra" checked data-v-03a8e4bc> Fecha trapaso a lista negra </label></div></fieldset>',1),Ic={name:"fieldSetFiltrosOportunidad"},Ec=(0,i.uE)('<h4 style="color:blue;" data-v-03a8e4bc> Filtros </h4><input id="txtIdListaNegra" type="text" placeholder="ID Lista negra" data-v-03a8e4bc><input id="txtIdOportunidad" type="text" placeholder="ID Oportunidad" data-v-03a8e4bc><input id="txtProductoOportunidad" type="text" placeholder="Producto" data-v-03a8e4bc><input id="txtEmpresaOportunidad" type="text" placeholder="Empresa" data-v-03a8e4bc><input id="txtCreador" type="text" placeholder="Creador" data-v-03a8e4bc><input id="txtMotivo" type="text" placeholder="Motivo" data-v-03a8e4bc><input id="txtComercialAsignado" type="text" placeholder="Comercial asignado" data-v-03a8e4bc><hr data-v-03a8e4bc>',9),Fc=Sc((()=>(0,i._)("label",{for:"txtFechaDesdeAccionOportunidad"},"Fecha traspaso Desde:",-1))),Pc=Sc((()=>(0,i._)("label",{for:"txtFechaHastaAccionOportunidad"},"Fecha traspaso Hasta:",-1))),qc=Sc((()=>(0,i._)("hr",null,null,-1))),zc=Sc((()=>(0,i._)("label",{for:"order-select"},"Ordenar por ",-1))),Nc=(0,i.uE)('<option value="fecha_desc" data-v-03a8e4bc> Fecha acción (más nuevo a más antiguo) </option><option value="fecha_asc" data-v-03a8e4bc> Fecha acción (más antiguo a más nuevo) </option><option value="producto" data-v-03a8e4bc> Producto </option><option value="empresa" data-v-03a8e4bc> Empresa </option><option value="creador" data-v-03a8e4bc> Creador </option><option value="motivo" data-v-03a8e4bc> Motivo </option>',6),Rc=[Nc],jc={class:"custom-table"},Vc={key:0},Tc={key:1},Mc={key:2},Lc={key:3},Uc={key:4},Hc={key:5},Bc={key:6},Zc={key:7},$c={key:8},Jc={key:9},Wc={key:0},Yc={key:1},Gc={key:2},Qc={key:3},Kc={key:4},Xc={key:5},er={key:6},ar={key:7},or={key:8},tr={key:9};function ir(e,a,o,r,n,d){return(0,i.wg)(),(0,i.iD)("div",null,[_c,Dc,(0,i._)("div",null,[xc,(0,i._)("fieldset",Ic,[Ec,(0,i._)("div",null,[Fc,(0,i.wy)((0,i._)("input",{id:"txtFechaDesdeAccionOportunidad","onUpdate:modelValue":a[0]||(a[0]=e=>n.fechaDesde=e),type:"date"},null,512),[[t.nr,n.fechaDesde]])]),(0,i._)("div",null,[Pc,(0,i.wy)((0,i._)("input",{id:"txtFechaHastaAccionOportunidad","onUpdate:modelValue":a[1]||(a[1]=e=>n.fechaHasta=e),type:"date"},null,512),[[t.nr,n.fechaHasta]])]),qc,zc,(0,i.wy)((0,i._)("select",{id:"order-select","onUpdate:modelValue":a[2]||(a[2]=e=>n.selectedOrder=e)},Rc,512),[[t.bM,n.selectedOrder]]),(0,i._)("button",{id:"btn_ejecutar_consulta",onClick:a[3]||(a[3]=(...e)=>d.ejecutarConsulta&&d.ejecutarConsulta(...e))}," Ejecutar consulta "),(0,i._)("button",{class:"botonExportar",onClick:a[4]||(a[4]=(...e)=>d.exportarCSV&&d.exportarCSV(...e))}," Exportar tabla a CSV ")])]),(0,i._)("div",null,[(0,i._)("table",jc,[(0,i._)("thead",null,[(0,i._)("tr",null,[d.isColumnSelected("checkIdListaNegra")?((0,i.wg)(),(0,i.iD)("th",Vc," ID ")):(0,i.kq)("",!0),d.isColumnSelected("checkIdOportunidad")?((0,i.wg)(),(0,i.iD)("th",Tc," ID oportunidad ")):(0,i.kq)("",!0),d.isColumnSelected("checkProductoOportunidad")?((0,i.wg)(),(0,i.iD)("th",Mc," Producto ")):(0,i.kq)("",!0),d.isColumnSelected("checkEmpresaOportunidad")?((0,i.wg)(),(0,i.iD)("th",Lc," Empresa ")):(0,i.kq)("",!0),d.isColumnSelected("checkIdCreador")?((0,i.wg)(),(0,i.iD)("th",Uc," ID Creador ")):(0,i.kq)("",!0),d.isColumnSelected("checkCreador")?((0,i.wg)(),(0,i.iD)("th",Hc," Creador ")):(0,i.kq)("",!0),d.isColumnSelected("checkMotivo")?((0,i.wg)(),(0,i.iD)("th",Bc," Motivo ")):(0,i.kq)("",!0),d.isColumnSelected("checkComercialAsignado")?((0,i.wg)(),(0,i.iD)("th",Zc," Comercial asignado ")):(0,i.kq)("",!0),d.isColumnSelected("checkFechaOportunidad")?((0,i.wg)(),(0,i.iD)("th",$c," Fecha Creación Oportunidad ")):(0,i.kq)("",!0),d.isColumnSelected("checkFechaListaNegra")?((0,i.wg)(),(0,i.iD)("th",Jc," Fecha trapaso a Lista negra ")):(0,i.kq)("",!0)])]),(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.resultados,(e=>((0,i.wg)(),(0,i.iD)("tr",{key:e.id},[d.isColumnSelected("checkIdListaNegra")?((0,i.wg)(),(0,i.iD)("td",Wc,(0,c.zw)(e.id),1)):(0,i.kq)("",!0),d.isColumnSelected("checkIdOportunidad")?((0,i.wg)(),(0,i.iD)("td",Yc,(0,c.zw)(e.idOportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkProductoOportunidad")?((0,i.wg)(),(0,i.iD)("td",Gc,(0,c.zw)(e.productoOportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkEmpresaOportunidad")?((0,i.wg)(),(0,i.iD)("td",Qc,(0,c.zw)(e.empresaOportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkIdCreador")?((0,i.wg)(),(0,i.iD)("td",Kc,(0,c.zw)(e.idCreador),1)):(0,i.kq)("",!0),d.isColumnSelected("checkCreador")?((0,i.wg)(),(0,i.iD)("td",Xc,(0,c.zw)(e.creador),1)):(0,i.kq)("",!0),d.isColumnSelected("checkMotivo")?((0,i.wg)(),(0,i.iD)("td",er,(0,c.zw)(e.motivo),1)):(0,i.kq)("",!0),d.isColumnSelected("checkComercialAsignado")?((0,i.wg)(),(0,i.iD)("td",ar,(0,c.zw)(e.comercialAsignado),1)):(0,i.kq)("",!0),d.isColumnSelected("checkFechaOportunidad")?((0,i.wg)(),(0,i.iD)("td",or,(0,c.zw)(d.formatFecha(e.fechaDiaOportunidad,e.fechaMesOportunidad,e.fechaAñoOportunidad)),1)):(0,i.kq)("",!0),d.isColumnSelected("checkFechaListaNegra")?((0,i.wg)(),(0,i.iD)("td",tr,(0,c.zw)(d.formatFecha(e.fechaDiaCreacion,e.fechaMesCreacion,e.fechaAñoCreacion)),1)):(0,i.kq)("",!0)])))),128))])])])])}var cr={components:{},data(){return{usuarios:[],query:"",parametrosQuery:[],selectedOrder:"fecha_desc",fechaDesde:null,fechaHasta:null,accion:"todas",resultados:[]}},computed:{},created(){this.comprobarCorreo()},methods:{formatFecha(e,a,o){const t=new Date(o,a-1,e);return t.toLocaleDateString("es-ES")},formatHora(e,a){return e=Math.max(0,Math.min(23,e)),a=Math.max(0,Math.min(59,a)),a<10&&(a="0"+a),e+":"+a},async comprobarCorreo(){const e=this.$store.state.correo;null===e&&this.$router.push({name:"LoginView"})},isColumnSelected(e){try{const a=document.getElementById(e);return a.checked}catch(a){return!0}},getMiId(){const e=localStorage.getItem("id"),a=JSON.parse(e);return a},async ejecutarConsulta(){try{const e=document.getElementById("txtIdListaNegra").value.trim(),a=document.getElementById("txtIdOportunidad").value.trim(),o=document.getElementById("txtProductoOportunidad").value.trim(),t=document.getElementById("txtEmpresaOportunidad").value.trim();let i=document.getElementById("txtCreador").value.trim(),c=document.getElementById("txtComercialAsignado").value.trim(),r=document.getElementById("txtMotivo").value.trim();const n=this.fechaDesde,d=this.fechaHasta,l=this.selectedOrder,s=await m.Z.post("/getListaNegra",{fechaDesde:n,fechaHasta:d,idListaNegra:e,idOportunidad:a,producto:o,empresa:t,creador:i,comercialAsignado:c,orden:l,motivo:r}),{message:u}=s.data;this.usuarios=JSON.parse(u),this.resultados=JSON.parse(s.data.message)}catch(e){console.error(e),this.message="Error al obtener los usuarios"}},exportarCSV(){const e=[],a=this.obtenerEncabezadosSeleccionados();e.push(a),this.usuarios.forEach((a=>{const o=this.obtenerDatosFila(a);e.push(o)}));let o="";e.forEach((e=>{o+=e.map((e=>`"${e}"`)).join(",")+"\n"}));const t=new Blob([o],{type:"text/csv;charset=utf-8;"}),i=window.URL.createObjectURL(t),c=document.createElement("a");c.setAttribute("href",i),c.setAttribute("download","tabla.csv"),c.style.display="none",document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(i)},obtenerEncabezadosSeleccionados(){const e=[];return this.isColumnSelected("checkIdListaNegra")&&e.push("ID"),this.isColumnSelected("checkIdOportunidad")&&e.push("ID Oportunidad"),this.isColumnSelected("checkProductoOportunidad")&&e.push("Producto"),this.isColumnSelected("checkEmpresaOportunidad")&&e.push("Empresa"),this.isColumnSelected("checkIdCreador")&&e.push("ID Creador"),this.isColumnSelected("checkCreador")&&e.push("Creador"),this.isColumnSelected("checkCreador")&&e.push("Motivo"),this.isColumnSelected("checkComercialAsignado")&&e.push("Comercial Asignado"),this.isColumnSelected("checkFechaOportunidad")&&e.push(" Fecha Creación Oportunidad "),this.isColumnSelected("checkFechaListaNegra")&&e.push(" Fecha traspaso a lista negra "),e},obtenerDatosFila(e){const a=[];if(this.isColumnSelected("checkIdListaNegra")&&a.push(e.id),this.isColumnSelected("checkIdOportunidad")&&a.push(e.idOportunidad),this.isColumnSelected("checkProductoOportunidad")&&a.push(e.productoOportunidad),this.isColumnSelected("checkEmpresaOportunidad")&&a.push(e.empresaOportunidad),this.isColumnSelected("checkIdCreador")&&a.push(e.idCreador),this.isColumnSelected("checkCreador")&&a.push(e.creador),this.isColumnSelected("checkCreador")&&a.push(e.motivo),this.isColumnSelected("checkComercialAsignado")&&a.push(e.comercialAsignado),this.isColumnSelected("checkFechaOportunidad")){const o=this.formatFecha(e.fechaDiaOportunidad,e.fechaMesOportunidad,e.fechaAñoOportunidad);a.push(o)}if(this.isColumnSelected("checkFechaListaNegra")){const o=this.formatFecha(e.fechaDiaCreacion,e.fechaMesCreacion,e.fechaAñoCreacion);a.push(o)}return a}}};const rr=(0,k.Z)(cr,[["render",ir],["__scopeId","data-v-03a8e4bc"]]);var nr=rr;const dr=e=>((0,i.dD)("data-v-cf3c7d16"),e=e(),(0,i.Cn)(),e),lr=dr((()=>(0,i._)("hr",null,null,-1))),sr=dr((()=>(0,i._)("hr",null,null,-1))),ur=(0,i.uE)('<fieldset name="fieldsetMostrarColumnasOportunidades" data-v-cf3c7d16><h4 style="color:blue;" data-v-cf3c7d16> Mostrar columnas clientes </h4><br data-v-cf3c7d16><div class="checkbox-container" data-v-cf3c7d16><label data-v-cf3c7d16><input id="checkIdCliente" type="checkbox" name="checkIdCliente" checked data-v-cf3c7d16> Id </label><label data-v-cf3c7d16><input id="checkProducto" type="checkbox" name="checkProducto" data-v-cf3c7d16> Producto </label><label data-v-cf3c7d16><input id="checkEmpresa" type="checkbox" name="checkEmpresa" checked data-v-cf3c7d16> Empresa </label><label data-v-cf3c7d16><input id="checkPoblacion" type="checkbox" name="checkPoblacion" checked data-v-cf3c7d16> Poblacion </label><label data-v-cf3c7d16><input id="checkNombre" type="checkbox" name="checkNombre" data-v-cf3c7d16> Nombre </label><label data-v-cf3c7d16><input id="checkApellido1" type="checkbox" name="checkApellido1" checked data-v-cf3c7d16> Apellido1 </label><label data-v-cf3c7d16><input id="checkApellido2" type="checkbox" name="checkApellido2" checked data-v-cf3c7d16> Apellido2 </label><label data-v-cf3c7d16><input id="checkTelefono1" type="checkbox" name="checkTelefono1" data-v-cf3c7d16> Teléfono 1 </label><label data-v-cf3c7d16><input id="checkTelefono2" type="checkbox" name="checkTelefono2" checked data-v-cf3c7d16> Teléfono 2 </label></div><div class="checkbox-container" data-v-cf3c7d16><label data-v-cf3c7d16><input id="checkCorreo1" type="checkbox" name="checkCorreo1" checked data-v-cf3c7d16> Correo1 </label><label data-v-cf3c7d16><input id="checkCorreo2" type="checkbox" name="checkCorreo2" data-v-cf3c7d16> Correo2 </label><label data-v-cf3c7d16><input id="checkIdComercialAsignado" type="checkbox" name="checkIdComercialAsignado" checked data-v-cf3c7d16> ID Comercial Asignado </label><label data-v-cf3c7d16><input id="checkComercialAsignado" type="checkbox" name="checkComercialAsignado" data-v-cf3c7d16> Comercial asignado </label><label data-v-cf3c7d16><input id="checkFechaCreacionCliente" type="checkbox" name="checkFechaCreacionCliente" checked data-v-cf3c7d16> Fecha creación cliente </label></div></fieldset>',1),pr={name:"fieldSetFiltrosOportunidad"},hr=(0,i.uE)('<h4 style="color:blue;" data-v-cf3c7d16> Filtros </h4><input id="txtIdCliente" type="text" placeholder="ID cliente" data-v-cf3c7d16><input id="txtProductoCliente" type="text" placeholder="Producto" data-v-cf3c7d16><input id="txtEmpresaCliente" type="text" placeholder="Empresa" data-v-cf3c7d16><input id="txtPoblacionCliente" type="text" placeholder="Poblacion" data-v-cf3c7d16><input id="txtNombreCliente" type="text" placeholder="Nombre" data-v-cf3c7d16><input id="txtApellido1" type="text" placeholder="Apellido1" data-v-cf3c7d16><input id="txtApellido2" type="text" placeholder="Apellido2" data-v-cf3c7d16><input id="txtTelefono1" type="text" placeholder="Teléfono1" data-v-cf3c7d16><input id="txtTelefono2" type="text" placeholder="Teléfono2" data-v-cf3c7d16><input id="txtCorreo1" type="text" placeholder="Correo1" data-v-cf3c7d16><input id="txtCorreo2" type="text" placeholder="Correo2" data-v-cf3c7d16>',12),mr={key:0,id:"txtComercialAsignado",type:"text",placeholder:"Comercial asignado"},gr=dr((()=>(0,i._)("hr",null,null,-1))),kr=dr((()=>(0,i._)("label",{for:"txtFechaDesdeCliente"},"Fecha Desde:",-1))),br=dr((()=>(0,i._)("label",{for:"txtFechaHastaCliente"},"Fecha Hasta:",-1))),fr=dr((()=>(0,i._)("hr",null,null,-1))),vr=dr((()=>(0,i._)("label",{for:"order-select"},"Ordenar por ",-1))),Cr=dr((()=>(0,i._)("option",{value:"fecha_desc"}," Fecha acción (más nuevo a más antiguo) ",-1))),Ar=dr((()=>(0,i._)("option",{value:"fecha_asc"}," Fecha acción (más antiguo a más nuevo) ",-1))),yr=dr((()=>(0,i._)("option",{value:"producto"}," Producto ",-1))),wr=dr((()=>(0,i._)("option",{value:"empresa"}," Empresa ",-1))),Or={key:0,value:"autor"},Sr=dr((()=>(0,i._)("option",{value:"accion"}," Acción ",-1))),_r=dr((()=>(0,i._)("option",{value:"ri"}," RI ",-1))),Dr=dr((()=>(0,i._)("option",{value:"completada"}," Completada ",-1))),xr={class:"custom-table"},Ir={key:0},Er={key:1},Fr={key:2},Pr={key:3},qr={key:4},zr={key:5},Nr={key:6},Rr={key:7},jr={key:8},Vr={key:9},Tr={key:10},Mr={key:11},Lr={key:12},Ur={key:13},Hr={key:0},Br={key:1},Zr={key:2},$r={key:3},Jr={key:4},Wr={key:5},Yr={key:6},Gr={key:7},Qr={key:8},Kr={key:9},Xr={key:10},en={key:11},an={key:12},on={key:13};function tn(e,a,o,r,n,d){return(0,i.wg)(),(0,i.iD)("div",null,[lr,sr,(0,i._)("div",null,[ur,(0,i._)("fieldset",pr,[hr,e.$store.state.esAdmin?((0,i.wg)(),(0,i.iD)("input",mr)):(0,i.kq)("",!0),gr,(0,i._)("div",null,[kr,(0,i.wy)((0,i._)("input",{id:"txtFechaDesdeCliente","onUpdate:modelValue":a[0]||(a[0]=e=>n.fechaDesde=e),type:"date"},null,512),[[t.nr,n.fechaDesde]])]),(0,i._)("div",null,[br,(0,i.wy)((0,i._)("input",{id:"txtFechaHastaCliente","onUpdate:modelValue":a[1]||(a[1]=e=>n.fechaHasta=e),type:"date"},null,512),[[t.nr,n.fechaHasta]])]),fr,vr,(0,i.wy)((0,i._)("select",{id:"order-select","onUpdate:modelValue":a[2]||(a[2]=e=>n.selectedOrder=e)},[Cr,Ar,yr,wr,e.$store.state.esAdmin?((0,i.wg)(),(0,i.iD)("option",Or," Autor de la acción ")):(0,i.kq)("",!0),Sr,_r,Dr],512),[[t.bM,n.selectedOrder]]),(0,i._)("button",{id:"btn_ejecutar_consulta",onClick:a[3]||(a[3]=(...e)=>d.ejecutarConsulta&&d.ejecutarConsulta(...e))}," Ejecutar consulta "),(0,i._)("button",{class:"botonExportar",onClick:a[4]||(a[4]=(...e)=>d.exportarCSV&&d.exportarCSV(...e))}," Exportar tabla a CSV ")])]),(0,i._)("div",null,[(0,i._)("table",xr,[(0,i._)("thead",null,[(0,i._)("tr",null,[d.isColumnSelected("checkIdCliente")?((0,i.wg)(),(0,i.iD)("th",Ir," ID ")):(0,i.kq)("",!0),d.isColumnSelected("checkProducto")?((0,i.wg)(),(0,i.iD)("th",Er," Producto ")):(0,i.kq)("",!0),d.isColumnSelected("checkEmpresa")?((0,i.wg)(),(0,i.iD)("th",Fr," Empresa ")):(0,i.kq)("",!0),d.isColumnSelected("checkPoblacion")?((0,i.wg)(),(0,i.iD)("th",Pr," Poblacion ")):(0,i.kq)("",!0),d.isColumnSelected("checkNombre")?((0,i.wg)(),(0,i.iD)("th",qr," Nombre ")):(0,i.kq)("",!0),d.isColumnSelected("checkApellido1")?((0,i.wg)(),(0,i.iD)("th",zr," Apellido1 ")):(0,i.kq)("",!0),d.isColumnSelected("checkApellido2")?((0,i.wg)(),(0,i.iD)("th",Nr," Apellido2 ")):(0,i.kq)("",!0),d.isColumnSelected("checkTelefono1")?((0,i.wg)(),(0,i.iD)("th",Rr," Teléfono1 ")):(0,i.kq)("",!0),d.isColumnSelected("checkTelefono2")?((0,i.wg)(),(0,i.iD)("th",jr," Teléfono2 ")):(0,i.kq)("",!0),d.isColumnSelected("checkCorreo1")?((0,i.wg)(),(0,i.iD)("th",Vr," Correo1 ")):(0,i.kq)("",!0),d.isColumnSelected("checkCorreo2")?((0,i.wg)(),(0,i.iD)("th",Tr," Correo2 ")):(0,i.kq)("",!0),d.isColumnSelected("checkIdComercialAsignado")?((0,i.wg)(),(0,i.iD)("th",Mr," ID Comercial asignado ")):(0,i.kq)("",!0),d.isColumnSelected("checkComercialAsignado")?((0,i.wg)(),(0,i.iD)("th",Lr," Comercial asignado ")):(0,i.kq)("",!0),d.isColumnSelected("checkFechaCreacionCliente")?((0,i.wg)(),(0,i.iD)("th",Ur," Fecha Creación Cliente ")):(0,i.kq)("",!0)])]),(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.resultados,(e=>((0,i.wg)(),(0,i.iD)("tr",{key:e.idAccion},[d.isColumnSelected("checkIdCliente")?((0,i.wg)(),(0,i.iD)("td",Hr,(0,c.zw)(e.idCliente),1)):(0,i.kq)("",!0),d.isColumnSelected("checkProducto")?((0,i.wg)(),(0,i.iD)("td",Br,(0,c.zw)(e.productoOportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkEmpresa")?((0,i.wg)(),(0,i.iD)("td",Zr,(0,c.zw)(e.empresaOportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkPoblacion")?((0,i.wg)(),(0,i.iD)("td",$r,(0,c.zw)(e.poblacionOportunidad),1)):(0,i.kq)("",!0),d.isColumnSelected("checkNombre")?((0,i.wg)(),(0,i.iD)("td",Jr,(0,c.zw)(e.nombreCliente),1)):(0,i.kq)("",!0),d.isColumnSelected("checkApellido1")?((0,i.wg)(),(0,i.iD)("td",Wr,(0,c.zw)(e.apellido1Cliente),1)):(0,i.kq)("",!0),d.isColumnSelected("checkApellido2")?((0,i.wg)(),(0,i.iD)("td",Yr,(0,c.zw)(e.apellido2Cliente),1)):(0,i.kq)("",!0),d.isColumnSelected("checkTelefono1")?((0,i.wg)(),(0,i.iD)("td",Gr,(0,c.zw)(e.telefono1Cliente),1)):(0,i.kq)("",!0),d.isColumnSelected("checkTelefono2")?((0,i.wg)(),(0,i.iD)("td",Qr,(0,c.zw)(e.telefono2Cliente),1)):(0,i.kq)("",!0),d.isColumnSelected("checkCorreo1")?((0,i.wg)(),(0,i.iD)("td",Kr,(0,c.zw)(e.correo1Cliente),1)):(0,i.kq)("",!0),d.isColumnSelected("checkCorreo2")?((0,i.wg)(),(0,i.iD)("td",Xr,(0,c.zw)(e.correo2Cliente),1)):(0,i.kq)("",!0),d.isColumnSelected("checkIdComercialAsignado")?((0,i.wg)(),(0,i.iD)("td",en,(0,c.zw)(e.idComercialAsignado),1)):(0,i.kq)("",!0),d.isColumnSelected("checkComercialAsignado")?((0,i.wg)(),(0,i.iD)("td",an,(0,c.zw)(e.correoComercial),1)):(0,i.kq)("",!0),d.isColumnSelected("checkFechaCreacionCliente")?((0,i.wg)(),(0,i.iD)("td",on,(0,c.zw)(d.formatFecha(e.fechaDiaCreacionCliente,e.fechaMesCreacionCliente,e.fechaAñoCreacionCliente)),1)):(0,i.kq)("",!0)])))),128))])])])])}var cn={components:{},data(){return{usuarios:[],query:"",parametrosQuery:[],selectedOrder:"fecha_desc",fechaDesde:null,fechaHasta:null,accion:"todas",completada:"todas",resultados:[],opcionEmitidoORecibido:"todas"}},computed:{},created(){this.comprobarCorreo()},methods:{formatFecha(e,a,o){if(isNaN(e)||isNaN(a)||isNaN(o))return"Fecha inválida";const t=new Date(o,a-1,e);return isNaN(t.getTime())?"Fecha inválida":t.toLocaleDateString("es-ES")},formatHora(e,a){return e=Math.max(0,Math.min(23,e)),a=Math.max(0,Math.min(59,a)),a<10&&(a="0"+a),e+":"+a},async comprobarCorreo(){const e=this.$store.state.correo;null===e&&this.$router.push({name:"LoginView"})},isColumnSelected(e){try{const a=document.getElementById(e);return a.checked}catch(a){return!0}},getMiId(){const e=localStorage.getItem("id"),a=JSON.parse(e);return a},async ejecutarConsulta(){try{const e=document.getElementById("txtIdCliente").value.trim(),a=document.getElementById("txtProductoCliente").value.trim(),o=document.getElementById("txtEmpresaCliente").value.trim(),t=document.getElementById("txtPoblacionCliente").value.trim(),i=document.getElementById("txtNombreCliente").value.trim(),c=document.getElementById("txtApellido1").value.trim(),r=document.getElementById("txtApellido2").value.trim(),n=document.getElementById("txtTelefono1").value.trim(),d=document.getElementById("txtTelefono2").value.trim(),l=document.getElementById("txtCorreo1").value.trim(),s=document.getElementById("txtCorreo2").value.trim();let u=Ac("usuario");this.$store.state.esAdmin&&(u=document.getElementById("txtComercialAsignado").value.trim());const p=this.fechaDesde,h=this.fechaHasta,g=this.selectedOrder,k=await m.Z.post("/getListaClientes",{txtIdCliente:e,txtProducto:a,txtEmpresa:o,txtPoblacion:t,txtNombre:i,txtApellido1:c,txtApellido2:r,txtTelefono1:n,txtTelefono2:d,txtCorreo1:l,txtCorreo2:s,txtComercialAsignado:u,fechaDesde:p,fechaHasta:h,selectedOrder:g}),{message:b}=k.data;this.usuarios=JSON.parse(b),this.resultados=JSON.parse(k.data.message)}catch(e){console.error(e),this.message="Error al obtener los clientes"}},exportarCSV(){const e=[],a=this.obtenerEncabezadosSeleccionados();e.push(a),this.usuarios.forEach((a=>{const o=this.obtenerDatosFila(a);e.push(o)}));let o="";e.forEach((e=>{o+=e.map((e=>`"${e}"`)).join(",")+"\n"}));const t=new Blob([o],{type:"text/csv;charset=utf-8;"}),i=window.URL.createObjectURL(t),c=document.createElement("a");c.setAttribute("href",i),c.setAttribute("download","tabla.csv"),c.style.display="none",document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(i)},obtenerEncabezadosSeleccionados(){const e=[];return this.isColumnSelected("checkIdCliente")&&e.push("ID"),this.isColumnSelected("checkProducto")&&e.push("Producto"),this.isColumnSelected("checkEmpresa")&&e.push("Empresa"),this.isColumnSelected("checkPoblacion")&&e.push("Poblacion"),this.isColumnSelected("checkNombre")&&e.push("Nombre"),this.isColumnSelected("checkApellido1")&&e.push("Apellido1"),this.isColumnSelected("checkApellido2")&&e.push("Apellido2"),this.isColumnSelected("checkTelefono1")&&e.push("Teléfono1"),this.isColumnSelected("checkTelefono2")&&e.push("Teléfono2"),this.isColumnSelected("checkCorreo1")&&e.push("Correo1"),this.isColumnSelected("checkCorreo2")&&e.push("Correo2"),this.isColumnSelected("checkIdComercialAsignado")&&e.push("ID comercial asignado"),this.isColumnSelected("checkComercialAsignado")&&e.push("Comercial asignado"),this.isColumnSelected("checkFechaCreacionCliente")&&e.push(" Fecha creación cliente "),e},obtenerDatosFila(e){const a=[];if(this.isColumnSelected("checkIdCliente")&&a.push(e.idCliente),this.isColumnSelected("checkProducto")&&a.push(e.productoOportunidad),this.isColumnSelected("checkEmpresa")&&a.push(e.empresaOportunidad),this.isColumnSelected("checkPoblacion")&&a.push(e.poblacionOportunidad),this.isColumnSelected("checkNombre")&&a.push(e.nombreCliente),this.isColumnSelected("checkApellido1")&&a.push(e.apellido1Cliente),this.isColumnSelected("checkApellido2")&&a.push(e.apellido2Cliente),this.isColumnSelected("checkTelefono1")&&a.push(e.telefono1Cliente),this.isColumnSelected("checkTelefono2")&&a.push(e.telefono2Cliente),this.isColumnSelected("checkCorreo1")&&a.push(e.correo1Cliente),this.isColumnSelected("checkCorreo2")&&a.push(e.correo2Cliente),this.isColumnSelected("checkIdComercialAsignado")&&a.push(e.idComercialAsignado),this.isColumnSelected("checkComercialAsignado")&&a.push(e.correoComercial),this.isColumnSelected("checkFechaCreacionCliente")){const o=this.formatFecha(e.fechaDiaCreacionCliente,e.fechaMesCreacionCliente,e.fechaAñoCreacionCliente);a.push(o)}return a}}};const rn=(0,k.Z)(cn,[["render",tn],["__scopeId","data-v-cf3c7d16"]]);var nn=rn,dn={components:{"lista-acciones-oportunidades":Oc,"lista-negra":nr,"lista-clientes":nn},data(){return{selectTablaAcciones:"",usuarios:[],query:"",parametrosQuery:[],selectedOrder:"fecha_desc",fechaDesde:null,fechaHasta:null,accion:"todas",completada:"todas",resultados:[],opcionEmitidoORecibido:"todas"}},computed:{},created(){this.comprobarCorreo()},methods:{async comprobarCorreo(){const e=this.$store.state.correo;null===e&&this.$router.push({name:"LoginView"})}}};const ln=(0,k.Z)(dn,[["render",Yt],["__scopeId","data-v-36aee114"]]);var sn=ln;const un=[{path:"/",name:"LoginView",component:N},{path:"/SingUpView",name:"SingUpView",component:W},{path:"/HomeView",name:"HomeView",component:X},{path:"/OportunidadesView",name:"OportunidadesView",component:Ro},{path:"/ListaAccionesView",name:"ListaAccionesView",component:sn},{path:"/TareasPendientesView",name:"TareasPendientesView",component:Rt},{path:"/ListaClientes",name:"ListaClientesView",component:nn}],pn=(0,y.p7)({history:(0,y.PO)("/crmweb/"),routes:un});var hn=pn,mn=o(3907);const gn=(0,mn.MT)({state:{correo:null,esAdmin:!1},mutations:{setCorreo(e,a){e.correo=a},setEsAdmin(e,a){e.esAdmin=a}}});var kn=gn;o(7024);m.Z.defaults.baseURL="http://localhost:3000";const bn=(0,t.ri)(A);bn.use(hn),bn.use(kn),bn.mount("#app")}},a={};function o(t){var i=a[t];if(void 0!==i)return i.exports;var c=a[t]={exports:{}};return e[t].call(c.exports,c,c.exports,o),c.exports}o.m=e,function(){var e=[];o.O=function(a,t,i,c){if(!t){var r=1/0;for(s=0;s<e.length;s++){t=e[s][0],i=e[s][1],c=e[s][2];for(var n=!0,d=0;d<t.length;d++)(!1&c||r>=c)&&Object.keys(o.O).every((function(e){return o.O[e](t[d])}))?t.splice(d--,1):(n=!1,c<r&&(r=c));if(n){e.splice(s--,1);var l=i();void 0!==l&&(a=l)}}return a}c=c||0;for(var s=e.length;s>0&&e[s-1][2]>c;s--)e[s]=e[s-1];e[s]=[t,i,c]}}(),function(){o.d=function(e,a){for(var t in a)o.o(a,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){o.p="/crmweb/"}(),function(){var e={143:0};o.O.j=function(a){return 0===e[a]};var a=function(a,t){var i,c,r=t[0],n=t[1],d=t[2],l=0;if(r.some((function(a){return 0!==e[a]}))){for(i in n)o.o(n,i)&&(o.m[i]=n[i]);if(d)var s=d(o)}for(a&&a(t);l<r.length;l++)c=r[l],o.o(e,c)&&e[c]&&e[c][0](),e[c]=0;return o.O(s)},t=self["webpackChunkgonzapf27_github_io"]=self["webpackChunkgonzapf27_github_io"]||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))}();var t=o.O(void 0,[998],(function(){return o(2501)}));t=o.O(t)})();
//# sourceMappingURL=app.37862f14.js.map